<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>EMMA Reference Manual</title><link href="../skin/css/doc.css" rel="stylesheet" type="text/css"><meta content="DocBook XSL Stylesheets V1.66.1" name="generator"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="start"></a>EMMA Reference Manual</h1></div><div><p class="copyright">Copyright &copy; 2001-2004 Vlad Roubtsov</p></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#N10010">1. Installation and System Requirements</a></span></dt><dt><span class="chapter"><a href="#N100DC">2. EMMA Tool Reference</a></span></dt><dd><dl><dt><span class="sect1"><a href="#tool-ref.overview">1. Overview</a></span></dt><dt><span class="sect1"><a href="#tool-ref.run">2. <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10219">2.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.run.ANT">2.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.run.cmdline">2.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tool-ref.instr">3. <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#tool-ref.instr.description">3.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.instr.ANT">3.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.instr.cmdline">3.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tool-ref.report">4. <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10BF3">4.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.report.ANT">4.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.report.cmdline">4.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tool-ref.merge">5. <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#N110D9">5.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.merge.ANT">5.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.merge.cmdline">5.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N11272">6. Defining the instrumentation set</a></span></dt><dd><dl><dt><span class="sect2"><a href="#instrset.overview">6.1. How EMMA determines which classes get instrumented</a></span></dt><dt><span class="sect2"><a href="#instrset.filters">6.2. Coverage filters</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N11457">7. Common ANT task and command line options</a></span></dt><dd><dl><dt><span class="sect2"><a href="#commonoptions.ANT">7.1. Common ANT task attributes and nested elements</a></span></dt><dt><span class="sect2"><a href="#commonoptions.cmdline">7.2. common&nbsp;options</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#prop-ref">3. EMMA Property Reference</a></span></dt><dd><dl><dt><span class="sect1"><a href="#N115EB">1. Specifying EMMA properties</a></span></dt><dt><span class="sect1"><a href="#prop-ref.tables">2. EMMA property summary</a></span></dt></dl></dd><dt><span class="glossary"><a href="#N11B59">Glossary</a></span></dt></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>2.1. <a href="#N100EA">EMMA ANT tasks and command line tools</a></dt><dt>2.2. <a href="#N108B1"><span>&lt;instr&gt;</span>/<span>instr</span> output mode summary</a></dt><dt>2.3. <a href="#N11460">Common EMMA ANT task attributes</a></dt><dt>2.4. <a href="#N114D5">Common EMMA ANT task nested elements</a></dt><dt>3.1. <a href="#prop-ref.table.file">EMMA file
      output properties</a></dt><dt>3.2. <a href="#prop-ref.table.report">EMMA report
      generation properties</a></dt><dt>3.3. <a href="#prop-ref.table.instr">EMMA instrumentation properties</a></dt><dt>3.4. <a href="#prop-ref.table.verbosity">EMMA logging properties</a></dt></dl></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="N10010"></a>Chapter&nbsp;1.&nbsp;Installation and System Requirements</h2></div></div></div><p><b>Supported JRE versions.&nbsp;</b>EMMA has been implemented to work in any J2SE runtime
      environment. For performance reasons, EMMA tools and runtime can
      benefit from (but do not require) J2SE APIs available in J2SE versions 1.3
      and 1.4. EMMA command line tools, ANT tasks, and runtime have been
      tested in a variety of JREs from Sun Microsystem, IBM, and BEA.</p><p><b>Supported ANT versions.&nbsp;</b>EMMA ANT tasks work with Apache ANT 1.4.1 and later
      versions.</p><p><b>External library dependencies.&nbsp;</b>EMMA has no external Java or native library dependencies.</p><p><b>Operating system.&nbsp;</b>EMMA is a pure Java application and does not use JVMPI or other
profiling interfaces requiring native libraries. It should provide identical
functionality on any operating system supported by J2SE
v1.2+<sup>[<a href="#ftn.N10027" name="N10027">1</a>]</sup>.</p><p><b>EMMA distribution.&nbsp;</b>EMMA is contained in two Java class archives (found in the
      <tt class="filename">lib</tt> subdirectory of EMMA distribution):
        <div class="variablelist"><dl><dt><span class="term"><tt class="filename">emma.jar</tt></span></dt><dd>Contains the implementation of EMMA core components
	      command line tools, and <span class="emphasis"><em>EMMA runtime classes</em></span>
	      (EMMA classes that are needed by Java application code that has been
	      instrumented for coverage).</dd><dt><span class="term"><tt class="filename">emma_ant.jar</tt></span></dt><dd>Contains the implementation of EMMA ANT tasks (this
	      archive depends on <tt class="filename">emma.jar</tt> and does not
	      overlap with it in content).</dd></dl></div>
      </p><p><b>General installation considerations.&nbsp;</b>"Installing" EMMA simply implies making
      <tt class="filename">emma.jar</tt> and <tt class="filename">emma_ant.jar</tt>
      available to the Java Runtime Environment (<span class="acronym">JRE</span>) and
      Apache ANT runtime, as appropriate.</p><p>There are two distinct runtime cases for EMMA:
      <div class="orderedlist"><ol type="a"><li>Execution of an EMMA command line tool or ANT task.</li><li>Execution of some Java code that has been instrumented for
	  coverage. Note that every EMMA-instrumented class becomes dependent on
	  EMMA runtime classes (contained in <tt class="filename">emma.jar</tt>).</li></ol></div>
   </p><p><a name="install.core"></a><b>Installing EMMA core/runtime library.&nbsp;</b>Accordingly, to run EMMA command line tools or EMMA-instrumented
      applications you need to add
      <tt class="filename">emma.jar</tt> to the appropriate JRE classpath. You
      can do it either via the <tt class="option">-cp</tt> JVM option or by adding
      <tt class="filename">emma.jar</tt> as an <span class="emphasis"><em>installed JRE extension</em></span> (by copying
      <tt class="filename">emma.jar</tt> to <tt class="filename">lib/ext</tt>
      subdirectory of your JRE or by setting the
      <tt class="option">java.ext.dirs</tt> JVM system property to include the
      <tt class="filename">lib</tt> subdirectory of EMMA distribution. See
      Sun's documentation on <a href="http://java.sun.com/docs/books/tutorial/ext/basics/install.html" target="_blank">Installed
      Extentions</a> and <a href="http://java.sun.com/j2se/1.4.2/docs/guide/extensions/spec.html#installed" target="_blank"><tt class="option">java.ext.dirs</tt></a>
      property for more details).

        <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a name="install.note.jreext"></a>The JRE extension option is preferred</h3><p>It is <span class="emphasis"><em>highly recommended</em></span> to install
	<tt class="filename">emma.jar</tt> as a JRE extension. This simplifies
	EMMA usage with application containers (IBM Websphere, BEA
	WebLogic, etc). Furthemore, installed JRE extensions are
	<span class="emphasis"><em>trusted</em></span> by default: the instrumented
	application classes will automatically have the necessary
	runtime permissions for dumping coverage data files. Note that the JRE used by
	an application container may not necessarily be the same one you use
	from command line or ANT.</p></div>

      </p><p><a name="install.ANT"></a><b>Setting up EMMA ANT tasks.&nbsp;</b>To run EMMA ANT tasks, one additional configuration step inside
      <tt class="filename">build.xml</tt> is required:</p><pre class="programlisting">
  &lt;!-- EMMA distribution directory: --&gt;
  &lt;property name='emma.dir' value='<span class="emphasis"><em>your EMMA install location</em></span>' /&gt;

  &lt;path id='emma.lib' &gt;
    &lt;fileset dir='${emma.dir}' includes='lib/*.jar' /&gt;
  &lt;/path&gt;

  &lt;taskdef resource='emma_ant.properties' classpathref='emma.lib' /&gt;</pre><p>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">EMMA lib path</h3><p>The <tt class="filename">build.xml</tt> snippet shown above defines a
      path element with <tt class="option">emma.lib</tt> reference id. Although
      this is not strictly necessary (the <tt class="option">&lt;classpath&gt;</tt>
      element nested inside the <tt class="option">&lt;taskdef&gt;</tt> could have worked
      just as well), such a path element usually comes in handy elsewhere in
      the <tt class="filename">build.xml</tt>.</p></div>
    </p><div class="footnotes"><br><hr align="left" width="100"><div class="footnote"><p><sup>[<a href="#N10027" name="ftn.N10027">1</a>] </sup>In a Sun Microsystems-compatible JRE prior to version
1.3 the runtime coverage data is dumped (in the offline coverage mode) only when
the JVM is terminated via <tt class="option">Ctrl-C</tt> or an equivalent
signal.</p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="N100DC"></a>Chapter&nbsp;2.&nbsp;EMMA Tool Reference</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#tool-ref.overview">1. Overview</a></span></dt><dt><span class="sect1"><a href="#tool-ref.run">2. <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10219">2.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.run.ANT">2.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.run.cmdline">2.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tool-ref.instr">3. <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#tool-ref.instr.description">3.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.instr.ANT">3.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.instr.cmdline">3.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tool-ref.report">4. <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#N10BF3">4.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.report.ANT">4.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.report.cmdline">4.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tool-ref.merge">5. <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="#N110D9">5.1. Description</a></span></dt><dt><span class="sect2"><a href="#tool-ref.merge.ANT">5.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="#tool-ref.merge.cmdline">5.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N11272">6. Defining the instrumentation set</a></span></dt><dd><dl><dt><span class="sect2"><a href="#instrset.overview">6.1. How EMMA determines which classes get instrumented</a></span></dt><dt><span class="sect2"><a href="#instrset.filters">6.2. Coverage filters</a></span></dt></dl></dd><dt><span class="sect1"><a href="#N11457">7. Common ANT task and command line options</a></span></dt><dd><dl><dt><span class="sect2"><a href="#commonoptions.ANT">7.1. Common ANT task attributes and nested elements</a></span></dt><dt><span class="sect2"><a href="#commonoptions.cmdline">7.2. common&nbsp;options</a></span></dt></dl></dd></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tool-ref.overview"></a>1.&nbsp;Overview</h2></div></div></div><p>EMMA functionality is implemented by a set of components
    responsible for class instrumentation, metadata and coverage data
    processing, and coverage report generation. Each component has
    adapters that expose its functionality as an ANT task and a
    command line tool. To reflect this design, each of the following
    reference subsections starts by detailing the overall functionality
    of a given component, followed by its concrete ANT and command line
    usage.</p><p>The following table summarizes EMMA ANT tasks and their equivalent
    command line tools:</p><p>
      <div class="table"><a name="N100EA"></a><p class="title"><b>Table&nbsp;2.1.&nbsp;EMMA ANT tasks and command line tools</b></p><table summary="EMMA ANT tasks and command line tools" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">ANT task</th><th align="left">Command line tool</th><th align="left">Functionality</th><th align="left">Output</th></tr></thead><tbody><tr><td colspan="4" align="center"><span class="emphasis"><em>on-the-fly
	      processing mode</em></span></td></tr><tr><td align="left"><a href="#tool-ref.run.ANT" title="2.2.&nbsp;ANT usage"><span><b class="command">&lt;emmajava&gt;</b></span></a></td><td align="left"><a href="#tool-ref.run.cmdline" title="2.3.&nbsp;Command line usage"><span><b class="command">emmarun</b></span></a></td><td align="left">Executes a standalone Java application in EMMA
	      instrumenting classloader without a separate instrumentation phase.</td><td align="left">One or several coverage reports and (optionally) a coverage
	      session raw data file.</td></tr><tr><td colspan="4" align="center"><span class="emphasis"><em>offline
	      processing mode</em></span></td></tr><tr><td align="left"><a href="#tool-ref.instr.ANT" title="3.2.&nbsp;ANT usage"><span><b class="command">&lt;instr&gt;</b></span></a>&nbsp;subtask</td><td align="left"><a href="#tool-ref.instr.cmdline" title="3.3.&nbsp;Command line usage"><span><b class="command">instr</b></span></a>&nbsp;command</td><td align="left">Instruments a set of classes in a given list of
	      directories and/or archives and output.</td><td align="left">Instrumented classes and archives and a coverage metadata file.</td></tr><tr><td align="left"><a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>&nbsp;subtask</td><td align="left"><a href="#tool-ref.report.cmdline" title="4.3.&nbsp;Command line usage"><span><b class="command">report</b></span></a>&nbsp;command</td><td align="left">Combines class metadata and coverage runtime data to
	      produce coverage reports.</td><td align="left">One or several coverage reports (plain text, HTML, XML).</td></tr><tr><td align="left"><a href="#tool-ref.merge.ANT" title="5.2.&nbsp;ANT usage"><span><b class="command">&lt;merge&gt;</b></span></a>&nbsp;subtask</td><td align="left"><a href="#tool-ref.merge.cmdline" title="5.3.&nbsp;Command line usage"><span><b class="command">merge</b></span></a>&nbsp;command</td><td align="left">Merges and compacts several metadata, coverage, or
	      session data files.</td><td align="left">A single merged coverage session data file.</td></tr></tbody></table></div>
    </p><p><b>Subtasks and commands.&nbsp;</b>For reasons that include modularity and consistency of
      common option behavior EMMA offline coverage tools are used as
      subtasks of the "umbrella" <span><b class="command">&lt;emma&gt;</b></span> ANT
      task:</p><pre class="programlisting">

    &lt;emma ...&gt;
      &lt;merge ...&gt;
        ...
      &lt;/merge&gt;
      &lt;report ...&gt;
        ...
      &lt;/report&gt;
    &lt;/emma&gt;
    </pre><p>or as subcommands of the "umbrella" <span><b class="command">emma</b></span>
    command line command:</p><pre class="screen">
&gt;java emma instr -ip out/classes/ ...
&gt;java emma report -in coverage.em,coverage.ec ...</pre><p>Note that in the ANT case, <span><b class="command">&lt;emma&gt;</b></span> can
    contain an arbitrary sequence of subtasks (including mutliple subtasks of the
    same kind, which are executed in the exact sequence as they are
    specified). In addition to the already mentioned advantages, this allows
    entire blocks of EMMA tool invocations to be enabled/disabled and
    configured using attributes of the parent <span><b class="command">&lt;emma&gt;</b></span> ANT task.</p><p><b>EMMA properties cascade.&nbsp;</b>Some aspects of EMMA tool/task behavior can be modified
	using properties which can be set in a variety of ways: via
	JVM system properties, via an external file, via ANT (sub)task
	attributes or command line tool options. The task-subtask
	organization helps with this EMMA configuration as well. The
	general rule of thumb here is that properties within a more specific
	context (an ANT subtask vs <span><b class="command">&lt;emma&gt;</b></span> parent task, a tool
	setting vs a global JVM	property, etc) inherit their values from the
	surrounding contexts, but can also override them. For complete details see
	<a href="#prop-ref.lookup" title="EMMA property lookup order.">EMMA property lookup order.</a></p><p>In the remainder of this manual, the same tool will be
      frequently referred to as
      <span><b class="command">&lt;<i class="replaceable"><tt>ANT_tool_name</tt></i>&gt;</b></span>/<span><b class="command"><i class="replaceable"><tt>command_line_tool_name</tt></i></b></span>.</p><p><b>Overall EMMA processing sequence.&nbsp;</b>The general sequence of steps when using EMMA depends on your
      chosen coverage mode:
        <div class="itemizedlist"><ul type="disc"><li><p>When using EMMA's on-the-fly coverage mode, there is little to do
	    in addition to how you would normally run your application or
	    testsuite: you use
	    <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> as the new startup
	    class and optionally tell it where to place the coverage
	    report(s)<sup>[<a href="#ftn.N101AD" name="N101AD">2</a>]</sup>.</p></li><li><p>When using EMMA's offline coverage mode, the general sequence of
	    tool/task invocations is:
              <div class="orderedlist"><ol type="1"><li><p>In one or several passes, use
		  <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span>
		  to instrument class directories and archive files.</p></li><li><p>Execute your application or test suite using the
		  instrumented classes (one or several runs).</p></li><li><p>Optionally, merge and compact all <a href="#mdata"><i class="glossterm">metadata</i></a> and
		  <a href="#rdata"><i class="glossterm">runtime coverage</i></a> files using <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span>.</p></li><li><p>In one or several passes, use
		  <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> to combine class metadata
		  with the desired runtime coverage
		  data profile(s) and generate the desired coverage report(s).</p></li></ol></div>
            </p></li></ul></div>
      </p><p><b>EMMA data files are untyped.&nbsp;</b>EMMA tools use binary data files for storing instrumentation
      and runtime coverage results. EMMA files are not typed: they do not
      require a particular name or extension. Furthermore, each data file is
      a mini-database that acts as an envelope for an arbitrary sequence of
      metadata and/or runtime coverage data dumps. It is up to the user how to
      structure their work with EMMA: either accumulate everything in a
      single file or use a dedicated file for every tool. The
      only restriction is that EMMA files can only grow (once new data is
      merged in, it cannot be removed).</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tool-ref.run"></a>2.&nbsp;<span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span></h2></div></div></div><p><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> &mdash; instrumented application runner (on-the-fly
      instrumentation mode).</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N10219"></a>2.1.&nbsp;Description</h3></div></div></div><p><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> pairs an advanced custom classloader with a
	combination of core internal components of <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> and
	<span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> to form a unique convenience tool in EMMA kit: an application
	runner that instruments classes <span class="emphasis"><em>on the fly</em></span> and generates coverage
	reports without any need for a separate build or any intermediate
	work files alltogether.</p><p><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> convenience is especially apparent in command line mode,
	because its option names intentionally mimick the familiar
	<span><b class="command">java</b></span> options: a Java application launch command
	line could be made coverage-enabled by inserting a single new word
	(<span><b class="command">emmarun</b></span>)
	into the command line. Similarly, the ANT version of this tool is an
	extension of ANT's standard &lt;java&gt; task. <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> can execute as
	little as a single Java class or as
	much as a complex Swing application made up of hundreds of classes,
	all with equally small instrumentation overhead.</p><p>Thinking of <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> as a combination of EMMA class
	instrumentor and report generator is a good way to remember its ANT
	attributes and command line options: in the reference sections that
	follow most of them are documented as identical to their namesakes
	in <a href="#tool-ref.instr" title="3.&nbsp;<instr>/instr"><span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></a> and <a href="#tool-ref.report" title="4.&nbsp;<report>/report"><span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></a>.</p><p><b>What gets instrumented.&nbsp;</b>The default <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> behavior is to instrument only the classes
	  that are loaded by the JVM for the running application. The
	  resulting report will not even mention classes that were never
	  loaded and which potentially decrease your coverage
	  percentages. If your objective is to get a complete coverage
	  report (as you would from an offline combination of <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> and
	  <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span>) you should use the <a href="#tool-ref.run.fullmetadata.ANT">option for a full classpath scan</a>,
	  possibly in combination with some <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">coverage filters</a>.</p><p><b>Compatibility.&nbsp;</b>At runtime, <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>'s instrumenting classloader installs
	  itself as the application classloader, bypassing the standard
	  system classloader. It uses a smart class
	  delegation strategy, whereby it automatically detects JRE core and
	  extension classes without having to filter by class names (the
	  frequently used, but inadequate, delegation strategy). Coupled
	  with full support for <tt class="option">Class-Path</tt> manifest entries
	  and <tt class="option">-jar</tt> option, the resulting EMMA runtime will
	  correctly run most standalone Java programs. However, certain cases are
	  exceptions:

            <div class="itemizedlist"><ul type="disc"><li>Java code referencing
		<tt class="function">java.lang.ClassLoader.getSystemClassLoader()</tt>
		(either directly or via
		<tt class="function">ClassLoader.findSystemClass()</tt> and
		related methods)
		instead of using the current or thread context loaders will
		bypass <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> classloader, causing subsequent classes to be
		loaded at the wrong node of the classloader hierarchy. Such coding patterns should
		really be considered bugs and are not supported. Such
		code could be patched up on the fly during instrumentation,
		but a reliable solution is expensive in terms of
		processing. Switching to offline instrumentation is an easy
		workaround.</li><li>Java applications designed around their own custom
		classloaders and classpaths most likely will not work with <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> (at
		best, they will run fine but coverage instrumention will not
		occur). Application containers (Apache tomcat, BEA
		Weblogic, IBM Websphere, etc) are the common case
		here. Again, switching to offline instrumentation is an easy
		alternative.</li></ul></div>

          </p><p><b><span><b class="command">&lt;emmajava&gt;</b></span> is always forked.&nbsp;</b>ANT's in-process classloading model is not sufficiently
	  JRE-compatible. ANT's class
	  delegation in the standard <span><b class="command">&lt;java&gt;</b></span> task in
	  <tt class="option">fork='false'</tt> (in-process) mode is
	  based on name matching (with a hardcoded set of name
	  filters) and inevitably fails for applications that depend on
	  non-standard JRE extensions. To support EMMA deployment as a JRE
	  extension <span><b class="command">&lt;emmajava&gt;</b></span> always forces
	  <tt class="option">fork='true'</tt> to ensure correct execution (unless
	  its <tt class="option">enabled</tt> attribute makes it a pass-through).</p><p><b>Internal EMMA properties that affect classloading and class instrumentation.&nbsp;</b>Several EMMA property settings affect instrumentation and
	   classloading behavior done by <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>:

            <div class="itemizedlist"><ul type="disc"><li><tt class="option"><a href="#prop-ref.instr.do_suid_compensation">instr.do_suid.compensation</a></tt></li><li><tt class="option"><a href="#prop-ref.instr.exclude_synthetic_methods">instr.exclude_synthetic_methods</a></tt></li><li><tt class="option"><a href="#prop-ref.instr.exclude_bridge_methods">instr.exclude_bridge_methods</a></tt></li></ul></div>
          </p><p>Changing the default classloading behavior should be done by
          experienced Java users only. Most of instrumentation-related
          properties should normally be left with their default
	values. <tt class="option"><a href="#prop-ref.instr.do_suid_compensation">instr.do_suid.compensation</a></tt>
	can be set to <tt class="option">false</tt> to gain extra instrumentation
	processing speed when runtime execution does not involve class
	de-serialization from existing files or serialization across
	JVMs.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.run.ANT"></a>2.2.&nbsp;ANT usage</h3></div></div></div><p><span><b class="command">&lt;emmajava&gt;</b></span> task is an implicit combination of <a href="#tool-ref.instr.ANT" title="3.2.&nbsp;ANT usage"><span><b class="command">&lt;instr&gt;</b></span></a>
	and <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>
	tasks and most of its attributes and nested elements are the same as
	for those two tasks combined.</p><h4><a name="N1031E"></a>Parameters specified as attributes</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="3" align="center">[<tt class="option"><a href="http://ant.apache.org/manual/CoreTasks/java.html" target="_blank">stock
		  ANT &lt;java&gt; task attributes</a></tt>]</td></tr><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task attributes</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.libclasspath.ANT"></a><tt class="option">libclasspath</tt></td><td align="left">A <i class="citetitle">path-like  structure</i>
		  containing EMMA core
		  (<tt class="filename">emma.jar</tt>).</td><td align="left">Yes, unless EMMA is <a href="#install.core">installed as
		  the JRE extension</a></td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.libclasspathref.ANT"></a><tt class="option">libclasspathref</tt></td><td align="left">Same as <tt class="option">libclasspath</tt>, but given as a reference to a
		  path defined elsewhere.</td><td align="left">Yes, unless EMMA is <a href="#install.core">installed as
		  the JRE extension</a></td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.fullmetadata.ANT"></a><tt class="option">fullmetadata</tt></td><td align="left">Indicates whether the entire classpath should be
		  added to the coverage metadata (default: <tt class="option">false</tt>).</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.dumpsession.ANT"></a><tt class="option">dumpsessiondata</tt></td><td align="left">Indicates whether the session (metadata+coverage)
		  data resulting from this coverage run should be dumped to
		  a file. Useful for post-run coverage report generation (default: <tt class="option">false</tt>).</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.sessiondatafile.ANT"></a><tt class="option">sessiondatafile</tt>, <tt class="option">outfile</tt></td><td align="left">If <tt class="option">dumpsessiondata='true'</tt>, overrides the location to store session data
		  (default: file <tt class="filename">coverage.es</tt> in the current
		  directory). Ignored otherwise.
		  </td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.merge.ANT"></a><tt class="option">merge</tt></td><td align="left">Indicates whether the session data should be merged
		  into the destination <tt class="option">sessiondatafile</tt>, if
		  any (default: <tt class="option">true</tt>). Any existing data is
		  clobbered otherwise.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.filter.ANT"></a><tt class="option">filter</tt></td><td align="left">Adds a coverage filter. See <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">Section&nbsp;6.2, &ldquo;Coverage filters&rdquo;</a> for
		  general description
		  of EMMA coverage filters and <a href="#filtersyntax.ANT" title="6.2.1.&nbsp;filter syntax: ANT">Section&nbsp;6.2.1, &ldquo;filter syntax: ANT&rdquo;</a>
		  specifically for ANT syntax. This attribute plays a role
		  equivalent to <a href="#tool-ref.instr.filter.ANT">the same attribute</a>
		  of <a href="#tool-ref.instr.ANT" title="3.2.&nbsp;ANT usage"><span><b class="command">&lt;instr&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.sourcepath.ANT"></a><tt class="option">sourcepath</tt></td><td align="left">A <i class="citetitle">path-like structure</i> that can be used
                  to point the HTML report generator in <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> to the location of your Java
                  source files. It is interpreted as a list of
		  directories (separated by the OS-specific classpath
		  separator or comma) containing <tt class="filename">.java</tt>
		  source files. The local path names within each directory
		  should reflect class package names. This attribute is equivalent to the
                  <a href="#tool-ref.report.sourcepath.ANT">same attribute
	          of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a> task</a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.sourcepathref.ANT"></a><tt class="option">sourcepathref</tt></td><td align="left">Same as <tt class="option">sourcepath</tt>, but given as a reference to a
		  path defined elsewhere.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.units.ANT"></a><tt class="option">units</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.units.ANT">the same attribute</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.depth.ANT"></a><tt class="option">depth</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.depth.ANT">the same attribute</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.columns.ANT"></a><tt class="option">columns</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.columns.ANT">the same attribute</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.sort.ANT"></a><tt class="option">sort</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.sort.ANT">the same attribute</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.metrics.ANT"></a><tt class="option">metrics</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.metrics.ANT">the same attribute</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.encoding.ANT"></a><tt class="option">encoding</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.encoding.ANT">the same attribute</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr></tbody></table></div>
          </p><h4><a name="N1047B"></a>Parameters specified as nested elements</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Element</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="3" align="center">[<tt class="option"><a href="http://ant.apache.org/manual/CoreTasks/java.html" target="_blank">stock
		  ANT &lt;java&gt; task nested elements</a></tt>]</td></tr><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task nested elements</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.nested.filter.ANT"></a><tt class="option">&lt;filter&gt;</tt></td><td align="left">Adds a coverage filter. See <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">Section&nbsp;6.2, &ldquo;Coverage filters&rdquo;</a> for
		  general description  of EMMA coverage filters and <a href="#filtersyntax.ANT" title="6.2.1.&nbsp;filter syntax: ANT">Section&nbsp;6.2.1, &ldquo;filter syntax: ANT&rdquo;</a> specifically for ANT
		  syntax. This nested element plays a role
		  equivalent to <a href="#tool-ref.instr.nested.filter.ANT">the same
		  element</a>  of <a href="#tool-ref.instr.ANT" title="3.2.&nbsp;ANT usage"><span><b class="command">&lt;instr&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.nested.sourcepath.ANT"></a><tt class="option">&lt;sourcepath&gt;</tt></td><td align="left">A <i class="citetitle">path-like structure</i> that can be used to point the HTML
	  report generator in <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> to the location of your Java source
	  files. This element is equivalent to the <a href="#tool-ref.report.nested.sourcepath.ANT">same nested element
	  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a> task</a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.nested.txt.ANT"></a><tt class="option">&lt;txt&gt;</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.nested.txt.ANT">the same nested element</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.nested.html.ANT"></a><tt class="option">&lt;html&gt;</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.nested.html.ANT">the same nested element</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No (<tt class="option">&lt;txt&gt;</tt> implied by default)</td></tr><tr><td align="left" valign="top"><a name="tool-ref.run.nested.xml.ANT"></a><tt class="option">&lt;xml&gt;</tt></td><td align="left">Equivalent to <a href="#tool-ref.report.nested.xml.ANT">the same nested element</a>
		  of <a href="#tool-ref.report.ANT" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>.</td><td align="left">No (<tt class="option">&lt;txt&gt;</tt> implied by default)</td></tr></tbody></table></div>
        </p><p><b><tt class="option">&lt;txt&gt;</tt>,
	<tt class="option">&lt;html&gt;</tt>, and <tt class="option">&lt;xml&gt;</tt> nested elements.&nbsp;</b>These nested elements create plain text, HTML, and XML
	  coverage reports, respectively. If none is specified, the plain
	  text report is implied (at most one configurator of any given report type
	  can be nested inside a given
	  <span><b class="command">&lt;emmajava&gt;</b></span> call). Configuration of these
	  elements is described in the <a href="#report.nestedcfg">equivalent section of <span><b class="command">&lt;report&gt;</b></span>
	  task</a> reference page.</p><h4><a name="N10547"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>Generate plain text and HTML reports with the default parameters:
<pre class="programlisting">
    &lt;emmajava enabled="${emma.enabled}" libclasspathref="emma.lib" 
              filter="${emma.filter}" sourcepath="${src.dir}"
              classname="Main" classpathref="run.classpath"
    &gt;
      &lt;!-- since this task is an extension of stock &lt;java&gt;, normal &lt;java&gt;
           options are still available: --&gt;
      &lt;arg value="someargvalue" /&gt;

      &lt;txt outfile="${coverage.dir}/coverage.txt" /&gt;
      &lt;html outfile="${coverage.dir}/coverage.html"  /&gt;
    &lt;/emmajava&gt;</pre>
            </p></li><li><p>Do a full metadata scan (of <tt class="constant">run.classpath</tt>), generate
            an HTML report with some customization, use a <span><b class="command">&lt;dirset&gt;</b></span>
            to set the sourcepath:
<pre class="programlisting">
    &lt;emmajava enabled="${emma.enabled}" libclasspathref="emma.lib" 
              fullmetadata="yes"
              classname="Main" classpathref="run.classpath"
    &gt;
      &lt;sourcepath&gt;
        &lt;dirset dir="${basedir}" &gt;
          &lt;include name="**/src" /&gt; 
        &lt;/dirset&gt;
      &lt;/sourcepath&gt;

      &lt;html outfile="${coverage.dir}/index.html"
            columns="name, method, line"
            sort="+line, +name"
            metrics="line:80"
      /&gt;
    &lt;/emmajava&gt;</pre>
            </p></li><li><p>Don't generate any reports, just dump the raw coverage session data
            for now:
<pre class="programlisting">
    &lt;emmajava enabled="${emma.enabled}" libclasspathref="emma.lib" 
              fullmetadata="yes" dumpsessiondata="yes"
              classname="Main"
              classpathref="run.classpath"
    /&gt;</pre>
            </p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.run.cmdline"></a>2.3.&nbsp;Command line usage</h3></div></div></div><h4><a name="N1056A"></a>Synopsis</h4><div class="cmdsynopsis"><p><tt class="command">java emmarun</tt>  [<i><a href="#tool-ref.run.restofopts">(1)</a>&nbsp;EMMA&nbsp;options</i>]  -cp <i class="replaceable"><tt>classpath</tt></i>...   <i class="replaceable"><tt>class</tt></i>  [<i class="replaceable"><tt>args</tt></i>...]<br><br><tt class="command">java emmarun</tt>  [<i><a href="#tool-ref.run.restofopts">(1)</a>&nbsp;EMMA&nbsp;options</i>]  -jar <i class="replaceable"><tt>jarfile</tt></i>  [<i class="replaceable"><tt>args</tt></i>...]<br><br><p><a name="tool-ref.run.restofopts">(1)</a> [-f] [-ix <i class="replaceable"><tt>filter patterns</tt></i>...] [-r <i class="replaceable"><tt>report&nbsp;types</tt></i>...] [-sp <i class="replaceable"><tt>sourcepath</tt></i>...] [-raw] [-out <i class="replaceable"><tt>session&nbsp;data&nbsp;file</tt></i>] [-merge <i class="replaceable"><tt>boolean</tt></i>] [<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common&nbsp;options</a></tt>]</p></p></div><p>alternative form:</p><div class="cmdsynopsis"><p><tt class="command">java emma run</tt>  {<i class="replaceable"><tt>same as above</tt></i>...}</p></div><h4><a name="N105DA"></a>Options</h4><p>[<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common command line options</a></tt>]</p><div class="variablelist"><dl><dt><a name="tool-ref.run.f.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-f, -fullmetadata</tt> </p></div>
            </span></dt><dd>This flag indicates whether the entire classpath
	      (<tt class="option">-cp</tt>) should be added to the coverage
	      metadata (default: <tt class="option">false</tt>). Without this flag,
	      only the classes explicitly loaded by the JVM will be in the
	      instrumentation set.</dd><dt><a name="tool-ref.run.ix.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-ix, -filter <i class="replaceable"><tt>filter&nbsp;patterns</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option adds a coverage filter. See <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">Section&nbsp;6.2, &ldquo;Coverage filters&rdquo;</a> for
		  general description
		  of EMMA coverage filters and <a href="#filtersyntax.cmdline" title="6.2.2.&nbsp;filter syntax: command line">Section&nbsp;6.2.2, &ldquo;filter syntax: command line&rdquo;</a>
		  specifically for command line syntax. It is equivalent to <a href="#tool-ref.instr.ix.cmdline">the same option</a>
		  of <a href="#tool-ref.instr.cmdline" title="3.3.&nbsp;Command line usage"><span><b class="command">instr</b></span></a>
		  tool.</dd><dt><a name="tool-ref.run.r.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-r, -report (<tt class="constant">txt</tt>|<tt class="constant">html</tt>|<tt class="constant">xml</tt>)</tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option selects the
	      type of coverage report(s) to generate
	      (default: <tt class="option">txt</tt>). It is equivalent to <a href="#tool-ref.report.r.cmdline">the same option</a>
	      of <a href="#tool-ref.report.cmdline" title="4.3.&nbsp;Command line usage"><span><b class="command">report</b></span></a>
	      tool.</dd><dt><a name="tool-ref.run.sp.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-sp, -sourcepath <i class="replaceable"><tt>list&nbsp;of&nbsp;source&nbsp;directories</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option can be used to point the HTML
	  report generator in <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> to the location of your Java source
	  files. Equivalent to <a href="#tool-ref.report.sp.cmdline">the same option</a>
		  of <a href="#tool-ref.report.cmdline" title="4.3.&nbsp;Command line usage"><span><b class="command">report</b></span></a>
		  tool.</dd><dt><a name="tool-ref.run.raw.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-raw, -sessiondata</tt> </p></div>
            </span></dt><dd>This flag indicates whether the session (metadata+coverage)
		  data resulting from this coverage run should be dumped to
		  a file. Useful for post-run coverage report generation (default: <tt class="option">false</tt>).</dd><dt><a name="tool-ref.run.out.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-out, -outfile <i class="replaceable"><tt>session&nbsp;data&nbsp;file</tt></i></tt> </p></div>
            </span></dt><dd>If <tt class="option">-raw</tt> flag is set, this option
		  overrides the location to store session data
		  (default: file <tt class="filename">coverage.es</tt> in the current
		  directory). Ignored otherwise.</dd><dt><a name="tool-ref.run.merge.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-merge (<tt class="constant">y[es]</tt>|<tt class="constant">n[o]</tt>)</tt> </p></div>
            </span></dt><dd>Indicates whether the session data should be merged
		  into the destination <tt class="option">outfile</tt>, if
		  any (default: <tt class="option">true</tt>). Any existing data is
		  clobbered otherwise.</dd><dt><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">report generation options</tt>... </p></div>
            </span></dt><dd><p>Unlike its ANT equivalent,
	      <span><b class="command">emmarun</b></span> command line tool does not have
	      dedicated options for controlling coverage report generation. If necessary, they can be
	      set using generic <a href="#commonoptions.property.cmdline">-D</a>, <a href="#commonoptions.properties.cmdline">-properties</a>,
	      and other mechanisms.</p><p>So, for example, to change the default location of
	      the HTML report you would override the <tt class="option"><a href="#prop-ref.report.out.file">report.out.file</a></tt> property:

<pre class="screen">
&gt;java emmarun -Dreport.html.out.file=mycoveragedir/myfile.html ...</pre>
             
             (<tt class="option">report.html.out.file</tt> can be abbreviated to
             <tt class="option">report.out.file</tt> if the command generates
             a single report type)</p></dd></dl></div><h4><a name="N106DD"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>Run an application and generate plain text and XML reports
            with default parameters:
<pre class="screen">
&gt;java emmarun -r txt,xml -jar SwingSet2.jar
</pre>
            </p></li><li><p>Run an application and generate an HTML report with some customization
            and linking to the application source code:
<pre class="screen">
&gt;java emmarun -r html -Dreport.columns=name,method,line -sp src/ -jar SwingSet2.jar
</pre>
            </p></li><li><p>Run an application and don't generate any reports, just dump the raw
            coverage session data:
<pre class="screen">
&gt;java emmarun -raw -jar SwingSet2.jar
</pre>
            </p></li></ul></div><h4><a name="N106F5"></a>Diagnostics</h4><p>The default EMMA command line tool behavior is not to use
	  <tt class="function">System.exit()</tt> on exit unless an explicit
	  <a href="#commonoptions.cmdline.exit"><tt class="option">-exit</tt></a>
	  option is specified. If that is done, the error codes returned via
	  <tt class="function">System.exit()</tt> are as follows:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col align="right"><col align="left"></colgroup><tbody><tr><td align="right" valign="top"><tt class="constant">0</tt></td><td align="left">Successful completion.</td></tr><tr><td align="right" valign="top"><tt class="constant">1</tt></td><td align="left">Failure due to incorrect option usage. This error
		  code is also returned when command line usage
                  (<a href="#commonoptions.cmdline.h"><tt class="option">-h</tt></a>)
                   is requested explicitly.</td></tr><tr><td align="right" valign="top"><tt class="constant">2</tt></td><td align="left">All other failures.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tool-ref.instr"></a>3.&nbsp;<span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></h2></div></div></div><p><span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> &mdash; offline class instrumentor.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.instr.description"></a>3.1.&nbsp;Description</h3></div></div></div><p><span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> is EMMA's offline class instrumentor. It adds bytecode
	instrumentation to all classes found in an <a href="#tool-ref.instr.instrpath.ANT">instrumentation
	path</a> that also pass through user-provided coverage
	filters. Additionally, it produces the <a href="#mdata"><i class="glossterm">class
	metadata</i></a> file necessary for associating <a href="#rdata"><i class="glossterm">runtime coverage data</i></a> with the original class
	definitions during coverage report generation.</p><p><a name="tool-ref.instr.instrpath"></a><b>Instrumentation path.&nbsp;</b>Note that the classes to be instrumented are taken from a
	path element that is exactly like the kind taken by normal JDK tools
	and ANT tasks: it is a list of directories (containing
	<tt class="filename">.class</tt> files) and
	<tt class="filename">.jar</tt>/<tt class="filename">.zip</tt>
	archives (specified as an arbitrary number of
	<a href="#tool-ref.instr.instrpath.ANT"><tt class="option">instrpath</tt></a>
	(<a href="#tool-ref.instr.ip.cmdline"><tt class="option">-ip</tt></a>) options). All
	non-existent or duplicate entries in the instrumentation path are
	effectively ignored during processing.

          <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><tt class="option">Class-Path</tt> manifest entries</h3><p>Note that <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> processes <tt class="option">Class-Path</tt>
	    entries in the manifests of class archives that it
	    encounters. This is by design and is the desirable behavior (especially in the
	    overwrite and fullcopy output modes), but care needs to be taken
	    to avoid processing unintended implicit path segments.</p></div>
	</p><p><a name="tool-ref.instr.outmodes"></a><b>Output modes.&nbsp;</b>To accomodate different build and testsuite designs
	<span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> has
	three different modes for how it outputs instrumented classes:
         <div class="variablelist"><dl><dt><span class="term"><tt class="option">copy</tt></span></dt><dd><p>In this mode, all instrumented classes are output
		to a single destination directory, regardless of whether the source
		classes came from a directory or an archive. Furthemore,
		only the classes and archive entries that are in the
		<a href="#instr.set"><i class="glossterm">instrumentation
		set</i></a> are written out. The idea here is to process
		just the necessary classes in as few disk I/O operations as
		possible.</p><p>For coverage-enabled application/testsuite runs
		the destination directory needs to be placed in the
		classpath ahead of the original classes. If this is
		inconvenient (say, because you need to package classes in
		archives before you can run), the <tt class="option">overwrite</tt>
		mode might be a better option. 
		</p></dd><dt><span class="term"><tt class="option">overwrite</tt></span></dt><dd><p>This mode is similar to <tt class="option">copy</tt>,
		except it overwrites the original class and archive
		files. This is ideal as a pre-packaging step turned on only
		when coverage-enabled application/testsuite runs are
		needed. Its advantage over the <tt class="option">copy</tt> mode is
		that it can do jar-to-jar processing and eliminates the need
		to prepend a special output directory to the classpath. Its
		disadvantage is the extra CPU and disk I/O times needed to
		duplicate archive entries that are not being
		instrumented<sup>[<a href="#ftn.N107B3" name="N107B3">3</a>]</sup>.</p><p></p></dd><dt><span class="term"><tt class="option">fullcopy</tt></span></dt><dd><p>This mode is a hybrid between <tt class="option">copy</tt>
		and <tt class="option">overwrite</tt>. It offers the convenience of
		mixed individual class file and jar-to-jar processing
		without having to overwrite the original content. In this
		mode, the destination directory is split into two subdirectories,
		<tt class="filename">classes</tt> and <tt class="filename">lib</tt>,
		which accept instrumented class files and instrumented class
		archives, respectively.</p><p>Note that because in this mode
		<span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span>
		has to copy the most content (both files and archive entries
		that are not being instrumented), this mode could be the
		slowest of the three. The exact performance behavior
		depends on the relative speeds of your CPU and I/O
		subsystems and on the relative content mixes between class files and class
		archives in the input.</p></dd></dl></div>
        By design, in all output modes that can do jar-to-jar processing
        <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> does not
        compress the instrumented zip entries in the output archives. This saves CPU
        time needed for doing compression, usually at an acceptable cost in the
        increased disk space taken by the affected archive files.
        </p><p><a name="tool-ref.instr.mdata"></a><b>Class coverage metadata.&nbsp;</b>An important byproduct of class instrumentation is <a href="#mdata"><i class="glossterm">class metadata</i></a>. As described in more
	  detail elsewhere, EMMA coverage is based on instrumenting basic
	  bytecode blocks. Every instrumentation run outputs a compact
	  representation of data necessary to associate coverage of an
	  individual basic block with its parent method and class as well as
	  the original Java source lines that map to this basic basic (there
	  is a metadata entry for every class in the instrumentation class set). Class
	  metadata from each offline instrumentation run needs to be saved in a disk
	  file, because it will be required for coverage stats computation
	  and coverage report generation.</p><p>Note that when <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> writes metadata into a file, it will by
	default <span class="emphasis"><em>merge</em></span> incoming metadata into the
	existing data in the destination file (if it exists). This behavior
	is also necessary to support <a href="#instr.incremental"><span class="emphasis"><em>incremental
	instrumentation</em></span></a>, as described shortly.</p><p><a name="tool-ref.instr.mdatamerging"></a><b>Class metadata merging.&nbsp;</b>To avoid any ambiguities, it is necessary to completely specify
	  how <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span>
	  resolves duplicate data during instrumentation path processing:
            <div class="orderedlist"><ol type="1"><li>During a given <a href="#instr.run"><i class="glossterm">instrumentation run</i></a>, all directory
		and archive entries in the instrumentation path are
		processed left-to-right. All duplicates (defined as entries
		with the same canonical file pathnames) are skipped. As
		noted above, valid <tt class="option">Class-Path</tt> manifest
		entries are also processed, in the order they are
		discovered. This sequence is thus the same as it would be
		for classloading lookup if the instrumentation path were
		used as a classpath.</li><li>It is still possible that during the same
		instrumentation run identical class names are encountered
		(e.g., if the same class name shows up in differently named
		archives). To stay consistent with classloading lookup rules
		(the first class definition in a classpath wins),
		<span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span>
		will instrument and emit metadata only for the first class
		definition it encounters.</li><li>Finally, it is possible that multiple metadata entries for
		idential class names are brought together when metadata from
		<span class="emphasis"><em>independent</em></span> instrumentation runs is merged together. The
		rule here is that the <span class="emphasis"><em>last</em></span> metadata
		entry wins. The last entry is defined as either the last one
		merged into a given metadata file or (in the case of multiple
		files) contained in the last file in a given input file
		set.</li></ol></div>
          </p><p>The last point is best illustrated with an example. If both
	<tt class="filename">coverageA.em</tt> and
	<tt class="filename">coverageB.em</tt> contain metadata for class
	<tt class="classname">MyClass</tt>:</p><pre class="screen">
&gt;java emma instr -ip ... -d coverageA.em ...
&gt;java emma instr -ip ... -d coverageB.em ...</pre><p>then the definition in <tt class="filename">coverageB.em</tt>
	wins in all these cases:</p><pre class="screen">
&gt;java emma report -in coverageA.em -in coverageB.em ...
&gt;java emma report -in coverageA.em,coverageB.em ...
&gt;java emma merge -in coverageA.em -in coverageB.em ...</pre><p>Similar rules apply to EMMA ANT tasks.</p><p><a name="instr.incremental"></a><b>Incremental instrumentation and metadata merging.&nbsp;</b>As is common knowledge, when working with
	  <span><b class="command">javac</b></span>, either from command line or via ANT's
	  <span><b class="command">&lt;javac&gt;</b></span> task, only the classes that were
	  modified since the last compilation get re-compiled. This is incredibly
	  convenient for an individual developer, as it makes a complex
	  product build incremental: small changes to the source code
	  results in quick incremental compiles. This is indispensable for
	  the "code some&mdash;test some&mdash;repeat" approach to software development.</p><p>EMMA can be used such that it fully preserves the
	incremental nature of a build. The key to this is how
	class metadata is merged when it is output to the same file. Suppose
	a developer executes the following actions (EMMA command line
	tools are used here for compactness, but the same is possible with
	an EMMA-enhanced ANT build):</p><pre class="screen">&gt;javac -g -d classes src/my/java/sources/*.java
&gt;java emma instr -ip classes ...
<span class="emphasis"><em>... edit some sources ...</em></span>
&gt;javac -g -d classes src/my/java/sources/*.java
<span class="emphasis"><em>... only the changed source files get re-compiled ...</em></span>
&gt;java emma instr -ip classes ...
<span class="emphasis"><em>... only the re-compiled class files get re-instrumented ...</em></span></pre><p>In this case <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> was either in <tt class="option">copy</tt>
	or in <tt class="option">overwrite</tt> mode and it implicitly used the same
	default coverage metadata repository file,
	<tt class="filename">coverage.em</tt>, for each
	instrumentation run. In the <tt class="option">copy</tt> mode, <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span>
	instruments only the class files whose instrumented versions in the
	output directory are older than their
	<span><b class="command">javac</b></span>-produced original versions. In
	the <tt class="option">overwrite</tt> mode case, <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> will instrument
	(and overwrite)	only the classes that are not already instrumented
	(because those would be the classes recently recompiled by
	<span><b class="command">javac</b></span>). All later metadata entries written to
	<tt class="filename">coverage.em</tt> override any earlier definitions
	and it all works out correctly (and very fast).</p><p>Because the metadata is always up-to-date in this scenario,
	the developer can run his/her tests and	look at coverage stats at
	any time he/she runs the tests, without doing an expensive
	rebuild of the entire project.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Runtime coverage data merging</h3><p>Note that the rules for merging <a href="#rdata"><i class="glossterm">runtime coverage data</i></a> are different: the
	data from different coverage runs is assumed to correspond to the
	same class definitions (in most cases EMMA will abort with an error
        if it detects a mismatch). Basic block coverage is merged such that the
	final coverage profile is a <span class="emphasis"><em>union</em></span> of all merged
	profiles.</p></div><p>The following table summarizes the major differences between
          <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> output modes:

          <div class="table"><a name="N108B1"></a><p class="title"><b>Table&nbsp;2.2.&nbsp;<span>&lt;instr&gt;</span>/<span>instr</span> output mode summary</b></p><table summary="<instr>/instr output mode summary" border="1"><colgroup><col align="left"><col align="center"><col align="center"><col align="left"></colgroup><thead><tr><th align="left">Mode</th><th align="left">Supports jar-to-jar processing</th><th align="left">Supports incremental instrumentation</th><th align="left">Output behavior</th></tr></thead><tbody><tr><td align="left"><tt class="option">copy</tt></td><td align="left">No</td><td align="left">Yes</td><td align="left">All instrumented classes are written to a single
		  destination directory (only instrumented entities are
		  written out), regardless of whether they come from
		  class files or class archives.</td></tr><tr><td align="left"><tt class="option">overwrite</tt></td><td align="left">Yes</td><td align="left">Yes</td><td align="left">Instrumented (and only instrumented) classes are
		  overwritten in-place. Instrumented (and only instrumented) archive
		  entries are updated in their archives.</td></tr><tr><td align="left"><tt class="option">fullcopy</tt></td><td align="left">Yes</td><td align="left">No</td><td align="left">All (instrumented or not) class files are written
		  to a <tt class="filename">classes</tt> subdirectory of the
		  destination directory. All (instrumented or not) class
		  archives are written out to a <tt class="filename">lib</tt>
		  subdirectory of the destination directory.</td></tr></tbody></table></div>
        </p><p><b>Internal EMMA properties that affect class instrumentation.&nbsp;</b>Several property settings affect <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> behavior:
	    <div class="itemizedlist"><ul type="disc"><li><tt class="option"><a href="#prop-ref.instr.do_suid_compensation">instr.do_suid.compensation</a></tt></li><li><tt class="option"><a href="#prop-ref.instr.exclude_synthetic_methods">instr.exclude_synthetic_methods</a></tt></li><li><tt class="option"><a href="#prop-ref.instr.exclude_bridge_methods">instr.exclude_bridge_methods</a></tt></li></ul></div>
          </p><p>Most of these should normally be left with their default
	values. <tt class="option"><a href="#prop-ref.instr.do_suid_compensation">instr.do_suid.compensation</a></tt>
	can be set to <tt class="option">false</tt> to gain extra instrumentation
	processing speed when runtime execution does not involve class
	de-serialization from existing files or serialization across
	JVMs.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.instr.ANT"></a>3.2.&nbsp;ANT usage</h3></div></div></div><h4><a name="N1092E"></a>Parameters specified as attributes</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task attributes</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.instrpath.ANT"></a><tt class="option">instrpath</tt></td><td align="left">A <i class="citetitle">path-like structure</i>
		  specifying the instrumentation path to use.</td><td align="left">Either this attribute, or <tt class="option">instrpathref</tt>
	          attribute, or at least one nested
	          <tt class="option">&lt;instrpath&gt;</tt> element must be present.</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.instrpathref.ANT"></a><tt class="option">instrpathref</tt></td><td align="left">Same as <tt class="option">instrpath</tt>, but given as a reference to a
		  path defined elsewhere.</td><td align="left">Either this attribute, or <tt class="option">instrpath</tt>
	          attribute, or at least one nested
	          <tt class="option">&lt;instrpath&gt;</tt> element must be present.</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.destdir.ANT"></a><tt class="option">destdir</tt>, <tt class="option">outdir</tt></td><td align="left">The location to store instrumented class files (in
	          <tt class="option">fullcopy</tt> mode instrumented classes are stored in
	         <tt class="option">destdir</tt><tt class="filename">/classes</tt> and
	         instrumented archives are stored in
	         <tt class="option">destdir</tt><tt class="filename">/lib</tt>
	         subdirectories, respectively). Ignored if <tt class="option">mode='overwrite'</tt>.</td><td align="left">Yes, unless <tt class="option">mode='overwrite'</tt></td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.metadatafile.ANT"></a><tt class="option">metadatafile</tt>, <tt class="option">outfile</tt></td><td align="left">The location to store class coverage metadata (default:
	          file <tt class="filename">coverage.em</tt> in the current
		  directory). Neither particular file name nor extension are
		  required.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.merge.ANT"></a><tt class="option">merge</tt></td><td align="left">Indicates whether the metadata should be merged into
	           the destination <tt class="option">metadatafile</tt>, if any
	          (default: <tt class="option">true</tt>). Any existing data is
		  clobbered otherwise.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.mode.ANT"></a><tt class="option">mode</tt></td><td align="left">Specifies the instrumentation output mode. Valid values
	           for this property are:<div class="itemizedlist"><ul type="disc"><li><tt class="option">copy</tt> (default): copy only instrumented
			class files and archive entries into
			<tt class="option">destdir</tt> directory.</li><li><tt class="option">overwrite</tt>: overwrite input
			class files and archives.</li><li><tt class="option">fullcopy</tt>: copy all
			(instrumented or not) class files and archives to
			<tt class="option">destdir</tt><tt class="filename">/classes</tt>
			and <tt class="option">destdir</tt><tt class="filename">/lib</tt>, respectively.</li></ul></div>
                  See <a href="#tool-ref.instr.description" title="3.1.&nbsp;Description">Section&nbsp;3.1, &ldquo;Description&rdquo;</a> for more details.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.filter.ANT"></a><tt class="option">filter</tt></td><td align="left">Adds an instrumentation filter. See <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">Section&nbsp;6.2, &ldquo;Coverage filters&rdquo;</a> for
		  general description of EMMA's instrumentation filters and <a href="#filtersyntax.ANT" title="6.2.1.&nbsp;filter syntax: ANT">Section&nbsp;6.2.1, &ldquo;filter syntax: ANT&rdquo;</a>
		  specifically for ANT syntax.</td><td align="left">No</td></tr></tbody></table></div>
          </p><h4><a name="N10A00"></a>Parameters specified as nested elements</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Element</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task nested elements</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.nested.instrpath.ANT"></a><tt class="option">&lt;instrpath&gt;</tt></td><td align="left">A <i class="citetitle">path-like structure</i> that specifies the instrumentation path to use.</td><td align="left">Either <tt class="option">instrpath</tt> attribute, or <tt class="option">instrpathref</tt>
	          attribute, or at least one nested
	          <tt class="option">&lt;instrpath&gt;</tt> element must be present.</td></tr><tr><td align="left" valign="top"><a name="tool-ref.instr.nested.filter.ANT"></a><tt class="option">&lt;filter&gt;</tt></td><td align="left">Adds an instrumentation filter. See <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">Section&nbsp;6.2, &ldquo;Coverage filters&rdquo;</a> for
		  general description of EMMA's instrumentation filters and <a href="#filtersyntax.ANT" title="6.2.1.&nbsp;filter syntax: ANT">Section&nbsp;6.2.1, &ldquo;filter syntax: ANT&rdquo;</a>
		  specifically for ANT syntax.</td><td align="left">No</td></tr></tbody></table></div>
        </p><p><b><tt class="option">&lt;instrpath&gt;</tt> nested elements.&nbsp;</b><tt class="option">&lt;instrpath&gt;</tt> is a <a href="http://ant.apache.org/manual/using.html#path" target="_blank"><i class="citetitle">path-like
	  structure</i></a> used to select class files and
	  archives to be processed for instrumentation. If a duplicate class
	  name is encountered during a single instrumentation pass, only
	  the first class definition will be added to the <a href="#mdata"><i class="glossterm">class metadata</i></a> emitted during this
	  instrumentation path. See <a href="#tool-ref.instr.mdatamerging" title="Class metadata merging.">Class metadata merging.</a> for more details.  </p><h4><a name="N10A6A"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>In-place instrument a certain subset of already compiled classes
            using <tt class="option">overwrite</tt> mode and several coverage filters:
<pre class="programlisting">
    &lt;emma enabled="${emma.enabled}" &gt;
      &lt;instr instrpathref="${out.dir}/classes"
             mode="overwrite"
      &gt;
        &lt;!-- always exclude every class with a "Test" in the name: --&gt;
        &lt;filter excludes="*Test*" /&gt;
        &lt;!-- don't instrument everything in "${out.dir}/classes",
             only the stuff I am working on now: --&gt;
        &lt;filter file="myincludes.txt" /&gt;
        &lt;!-- additional ANT command line hook: --&gt;
        &lt;filter value="${emma.filter}" /&gt;
      &lt;/instr&gt;
    &lt;/emma&gt;</pre>
            </p></li><li><p>Don't overwrite compiled classes that later need to go into official
            release jars (stay in <tt class="option">copy</tt> mode). However, use incremental
            instrumentation for fast personal testing: 
<pre class="programlisting">
    &lt;emma enabled="${emma.enabled}" &gt;
      &lt;instr instrpathref="${out.dir}/classes"
             outdir="${out.dir}/classes-instrumented"
             merge="yes"
             filter="${emma.filter}"
      /&gt;
    &lt;/emma&gt;</pre>
            </p></li><li><p>Take all jars already produced by the product build and make test
            (coverage-enabled) copies of them: 
<pre class="programlisting">
    &lt;emma enabled="${emma.enabled}" &gt;
      &lt;instr mode="fullcopy"
             outdir="${out.instr.dir}"
             merge="no"
             filter="${emma.filter}"
      &gt;
        &lt;instrpath&gt;
          &lt;fileset dir="${out.dir}" includes="**/*.jar" /&gt;
        &lt;/instrpath&gt;
      &lt;/instr&gt;
    &lt;/emma&gt;</pre>
            </p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.instr.cmdline"></a>3.3.&nbsp;Command line usage</h3></div></div></div><h4><a name="N10A8C"></a>Synopsis</h4><div class="cmdsynopsis"><p><tt class="command">java emma instr</tt>  {-ip <i class="replaceable"><tt>instrumentation&nbsp;path</tt></i>...} [-d <i class="replaceable"><tt>directory</tt></i>] [-out <i class="replaceable"><tt>metadata file</tt></i>] [-merge <i class="replaceable"><tt>boolean</tt></i>] [-m <i class="replaceable"><tt>output mode</tt></i>] [-ix <i class="replaceable"><tt>filter patterns</tt></i>...]<br> [<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common&nbsp;options</a></tt>]</p></div><h4><a name="N10AC0"></a>Options</h4><p>[<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common command line options</a></tt>]</p><div class="variablelist"><dl><dt><a name="tool-ref.instr.ip.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-ip, -cp, -instrpath <i class="replaceable"><tt>instrumentation&nbsp;path</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option sets the
	      instrumentation path to use. Besides the OS-specific separator
	      character, individual path segments can also be separated
	      with commas.</dd><dt><a name="tool-ref.instr.d.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-d, -dir, -outdir <i class="replaceable"><tt>directory</tt></i></tt> </p></div>
            </span></dt><dd>The location to store instrumented class files (in
	          <tt class="option">fullcopy</tt> mode instrumented classes are stored in
	         <tt class="option">destdir</tt><tt class="filename">/classes</tt> and
	         instrumented archives are stored in
	         <tt class="option">destdir</tt><tt class="filename">/lib</tt>
	         subdirectories, respectively). Ignored if
	          <tt class="option">-m</tt> is <tt class="option">overwrite</tt>.</dd><dt><a name="tool-ref.instr.out.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-out, -outfile <i class="replaceable"><tt>metadata&nbsp;file</tt></i></tt> </p></div>
            </span></dt><dd>The location to store class coverage metadata (default:
	          file <tt class="filename">coverage.em</tt> in the current
		  directory). Neither particular file name nor extension are
		  required.</dd><dt><a name="tool-ref.instr.merge.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-merge (<tt class="constant">y[es]</tt>|<tt class="constant">n[o]</tt>)</tt> </p></div>
            </span></dt><dd>This flag indicates whether the metadata should be merged into
	           the destination <tt class="option">-out</tt> file, if any
	          (default: <tt class="option">true</tt>). Any existing data is
		  clobbered otherwise.</dd><dt><a name="tool-ref.instr.m.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-m, -outmode (<tt class="constant">copy</tt>|<tt class="constant">overwrite</tt>|<tt class="constant">fullcopy</tt>)</tt> </p></div>
            </span></dt><dd><p>Specifies the instrumentation output mode. Valid values
	           for this property are:<div class="itemizedlist"><ul type="disc"><li><tt class="option">copy</tt> (default): copy only instrumented
			class files and archive entries into
			<tt class="option">destdir</tt> directory.</li><li><tt class="option">overwrite</tt>: overwrite input
			class files and archives.</li><li><tt class="option">fullcopy</tt>: copy all
			(instrumented or not) class files and archives to
			<tt class="option">destdir</tt><tt class="filename">/classes</tt>
			and <tt class="option">destdir</tt><tt class="filename">/lib</tt>, respectively.</li></ul></div>
                  See <a href="#tool-ref.instr.description" title="3.1.&nbsp;Description">Section&nbsp;3.1, &ldquo;Description&rdquo;</a> for more
                  details.
               </p></dd><dt><a name="tool-ref.instr.ix.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-ix, -filter <i class="replaceable"><tt>filter&nbsp;patterns</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option adds an instrumentation
		  filter. See <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters">Section&nbsp;6.2, &ldquo;Coverage filters&rdquo;</a> for
		  general description
		  of EMMA coverage filters and <a href="#filtersyntax.cmdline" title="6.2.2.&nbsp;filter syntax: command line">Section&nbsp;6.2.2, &ldquo;filter syntax: command line&rdquo;</a>
		  specifically for command line syntax.</dd></dl></div><h4><a name="N10B8B"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>In-place instrument a certain subset of already compiled classes
            using <tt class="option">overwrite</tt> mode and several coverage filters:
<pre class="screen">
&gt;java emma instr -m overwrite -ip out/classes -ix -*Test* -ix @myfilters.txt</pre>
            </p></li><li><p>Don't overwrite compiled classes that later need to go into official
            release jars (stay in <tt class="option">copy</tt> mode). However, use incremental
            instrumentation for fast personal testing: 
<pre class="screen">
&gt;java emma instr -merge y -ip out/classes -d out/classes-instrumented</pre>
            </p></li><li><p>Take all jars already produced by the product build and make test
            (coverage-enabled) copies of them: 
<pre class="screen">
&gt;java emma instr -m fullcopy -merge no -ip out/Product.jar -d out-instrumented/</pre>
            </p></li></ul></div><h4><a name="N10BA9"></a>Diagnostics</h4><p>The default EMMA command line tool behavior is not to use
	  <tt class="function">System.exit()</tt> on exit unless an explicit
	  <a href="#commonoptions.cmdline.exit"><tt class="option">-exit</tt></a>
	  option is specified. If that is done, the error codes returned via
	  <tt class="function">System.exit()</tt> are as follows:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col align="right"><col align="left"></colgroup><tbody><tr><td align="right" valign="top"><tt class="constant">0</tt></td><td align="left">Successful completion.</td></tr><tr><td align="right" valign="top"><tt class="constant">1</tt></td><td align="left">Failure due to incorrect option usage. This error
		  code is also returned when command line usage
                  (<a href="#commonoptions.cmdline.h"><tt class="option">-h</tt></a>)
                   is requested explicitly.</td></tr><tr><td align="right" valign="top"><tt class="constant">2</tt></td><td align="left">All other failures.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tool-ref.report"></a>4.&nbsp;<span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></h2></div></div></div><p><span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> &mdash; offline coverage report generator.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N10BF3"></a>4.1.&nbsp;Description</h3></div></div></div><p><span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> is EMMA's offline coverage report generator. It
reads in an arbitrary number of data files containing <a href="#mdata"><i class="glossterm">class metadata</i></a> and <a href="#rdata"><i class="glossterm">runtime coverage data</i></a> and generates one or
several coverage reports of desired types. Several aspects of coverage
reporting (detail level, column order, column sorting, coverage metrics
failure markup, etc) can be customized for a given report type.</p><p><b>What is reported on.&nbsp;</b>Each invocation of <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> requires a set of input
          <a href="#mdata"><i class="glossterm">metadata</i></a>  and <a href="#rdata"><i class="glossterm">runtime coverage data</i></a> files. EMMA
          coverage stats are derived exclusively from the classes that
          appear in the combined class metadata as represented by this
          input. To put it differently, a coverage report can reflect as
          much as the state of the entire product codebase or as little as
          one Java package or API being worked on by a given developer at
          the moment.</p><p><a name="tool-ref.reportdepth"></a><b>Report depth.&nbsp;</b>To understand EMMA's approach to generating coverage
	  reports, the following paradigm should be kept in mind:</p><p>
          <div class="itemizedlist"><ul type="disc"><li>a given coverage report covers all entities in the <a href="#instr.set"><i class="glossterm">instrumentation
		set</i></a>, referred to as <tt class="constant">all&nbsp;classes</tt> in the reports</li><li><tt class="constant">all&nbsp;classes</tt> entity contains Java packages</li><li>[for classes compiled with full debug info] Java
	      packages contain Java source files</li><li><p>
                <div class="itemizedlist"><ul type="circle"><li>[for classes compiled with full debug info]
		    Java source files contain Java classes (in general, more
		    than one)</li><li>[for classes compiled without full debug info]
		    Java packages contain Java classes </li></ul></div>
              </p></li><li>Java classes contain methods (which, in turn,
	      could be broken down into basic blocks)</li></ul></div>

        (The reason EMMA makes a distinction between classes with and
        without full debug info is that without the
        <tt class="classname">SourceFile</tt> attribute in all input classes it
        is in general impossible to make the association between classes and
        their source files and that in turn impacts how metrics
        like <a href="#coverage.line"><i class="glossterm">line coverage</i></a>
        are rolled up. The above hierarchy is easier to understand if you
        realize that without the full debug info the source file hierarchy
        level is absent.)</p><p>Correspondingly, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> calculates and presents coverage metrics in a way
	that allows for drilling down into data in a top-down fashion,
	starting with <tt class="constant">all&nbsp;classes</tt>
	and going all the way to the level of individual methods and
	source lines (in the HTML report). Coverage metrics are rolled up at the levels of
	individual methods, classes, source files, packages, and for the
	entire instrumentation set (<tt class="constant">all&nbsp;classes</tt>). The concept of "report
	depth" represents how deep you are in this hierarchy.</p><p>Different report types produced by <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> differ in
	how they reflect this data hierarchy:

          <div class="itemizedlist"><ul type="disc"><li>The plain text report is a low-overhead report type for
	      quick coverage summary viewing and processing by tools like
	      <span><b class="command">grep</b></span> and <span><b class="command">Perl</b></span>. It starts
	      with an <tt class="constant">all&nbsp;classes</tt> summary and progressively adds further
	      drill-down sections. Because a columnar plain text format is
	      limited in how well it can present hierarchical data, it is
	      recommended that for report depths beyond <tt class="option">all</tt>
	      and <tt class="option">package</tt> you use the HTML report instead.</li><li>The HTML report can provide the most detail and is
	      intended for human viewing. It starts with an <tt class="constant">all&nbsp;classes</tt>
	      summary page and for larger report depths links it to
	      package summary pages and then further to individual source
	      file and class summary pages. Source/class summary pages can
	      further embed source files and show method coverage rollups as
	      well as highlight individual source line coverage states.</li><li>The XML report exits for integration purposes and
	      leverages the tree structure of an XML document to most
	      truthfully represent the above-mentioned data hierarchy.</li></ul></div>

        Because generating certain report types for very large projects can
        be time-consuming, reducing the default report depth is a good way
        to limit the amount of detail that is generated, a useful feature
        for individual development work.</p><p>Valid values for a report depth are <tt class="option">all</tt>,
	<tt class="option">package</tt>, <tt class="option">source</tt>,
	<tt class="option">class</tt>, and <tt class="option">method</tt>. In general, a
	certain report depth value implies the level of detail that includes
	the summary for all items at that level as well as
	coverage breakdown summaries for their children. The amount of information rendered
	for a given depth value is always inclusive of
	lesser depth values, so increasing the report depth always increases
	the amount of details that is rendered. As a special case, when full debug info is
	available, <tt class="option">class</tt> is equivalent to
	<tt class="option">source</tt>.</p><p><a name="tool-ref.reportunits"></a><b>Report units.&nbsp;</b>EMMA coverage metrics could be
	  <span class="emphasis"><em>unweighted</em></span> or <span class="emphasis"><em>weighted</em></span>,
	  that is derived from basic block coverage where each block
	  counts either with an equal weight or with a weight proportional
	  to the number of Java bytecode instructions in it. The default
	  <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> behavior is to use weighted metrics. This includes all
	  metrics that are sensitive to basic block content: line and block
	  coverage. Weighted basic block coverage is a recommended metric for
          all situations, because it can simulate line coverage when no debug
          information has been compiled into application classes. If
	  desired, the traditional (unweighted) metrics could be
	  selected using the <a href="#tool-ref.report.units.ANT">units</a> option.</p><p><b>Coverage metrics.&nbsp;</b>A very useful feature of HTML and plain text reports created
	  by <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> is the ability to highlight entities that fail a given
	  <a href="#tool-ref.report.metrics.ANT">coverage
	  metric</a>. The plain text report does it by appending a "!"
	  to a failing coverage metric and the HTML report highlights those
	  in red. Combined with ability to <a href="#tool-ref.report.sort.ANT">sort</a> report columns, this feature
	  allows an individual developer to zoom in to the
	  packages and classes that demand the most attention with respect
	  to coverage.</p><p><a name="report.sourcepath"></a><b>Sourcepath and source linking.&nbsp;</b>Although EMMA coverage calculations are based on basic
	  block coverage profiling, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> can also map block coverage to
	  Java source file lines. If the HTML report generator is set
	  to <tt class="option">method</tt> depth and is configured with a valid
	  source path and the instrumented classes were compiled with enough
	  debug information, the generator will embed source files in the
	  source file/class summary report pages and highlight covered/not
	  covered lines accordingly. 

            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sourcepath and coverage stats</h3><p>Referencing the original Java source files is
	      optional during coverage report generation and does not affect
	      how EMMA coverage stats are computed (these stats are based
	      entirely on the <a href="#mdata"><i class="glossterm">class
	      metadata</i></a> and the debug info available in the
	      <tt class="filename">.class</tt> data at the instrumentation
	      time). However, to avoid report generation errors it is your
	      responsibility to ensure that the
	      versions of Java sources used for reporting are the same as
	      the ones used during instrumentation.</p></div>

          </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.report.ANT"></a>4.2.&nbsp;ANT usage</h3></div></div></div><h4><a name="N10CF0"></a>Parameters specified as attributes</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task attributes</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.sourcepath.ANT"></a><tt class="option">sourcepath</tt></td><td align="left">An optional source path to use for report
		  generation (a <i class="citetitle">path-like
		  structure</i>). It is interpreted as a list of
		  directories (separated by the OS-specific classpath
		  separator or comma) containing <tt class="filename">.java</tt>
		  source files. The local path names within each directory
		  should reflect class package names. (Currently, only the HTML report
		  generator uses this data, and only at
		  <tt class="option">method</tt> report depth.)</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.sourcepathref.ANT"></a><tt class="option">sourcepathref</tt></td><td align="left">Same as <tt class="option">sourcepath</tt>, but given as a
		  reference to a path defined elsewhere.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.units.ANT"></a><tt class="option">units</tt></td><td align="left">Specifies whether weighted or unweighted coverage
		  metrics are calculated. Valid values are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">instr</tt> (default):
		      use metrics weighted by bytecode instruction count;</li><li><tt class="option">count</tt>:
		      use traditional metric definitions (each basic block
		      has equal weight).</li></ul></div>
                  </td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.depth.ANT"></a><tt class="option">depth</tt></td><td align="left">Specifies the amount of detail to be included in
		  the generated coverage reports, as described in <a href="#tool-ref.reportdepth" title="Report depth.">Report depth.</a>. Valid values (in order
		  of increasing level of detail) are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">all</tt></li><li><tt class="option">package</tt></li><li><tt class="option">source</tt></li><li><tt class="option">class</tt></li><li><tt class="option">method</tt></li></ul></div>
                  (default values are report type-specific, see below)
                  </td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.columns.ANT"></a><tt class="option">columns</tt></td><td align="left">Specifies which report columns and in which order to use
		  for report generation, as a comma-separated list of column
		  ids. Valid column ids are the name of the item reported on and various
		  types of coverage: <tt class="option">name</tt>,
		  <tt class="option">class</tt>, <tt class="option">method</tt>,
		  <tt class="option">block</tt>, and <tt class="option">line</tt>.
		  Coverage types that are not available
		  for a given item type and debug info level are
		  automatically ignored. 
                  Reports can use only a subset of all possible columns (and
		  different report types can use different subsets).
		  Duplicate column names are ignored. Setting this attribute
		  is the same as setting
		  the <tt class="option"><a href="#prop-ref.report.columns">report.columns</a></tt> property for
		  all report types (default values are report type-specific,
		  see below).</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.sort.ANT"></a><tt class="option">sort</tt></td><td align="left">Specifies report column sorting order, as a
		  comma-separated list of column ids prefixed with
		  &ldquo;<span class="quote">+</span>&rdquo; for ascending or &ldquo;<span class="quote">-</span>&rdquo; for
		  descending directions. The first column id is the primary
		  sort and subsequent column ids are secondary sorts, in the
		  order given. Only the column ids specified by
		  <tt class="option">columns</tt> attribute are considered.
                  Setting this attribute is the same as setting
		  the <tt class="option"><a href="#prop-ref.report.sort">report.sort</a></tt> property for
		  all report types (default: <tt class="option">+block,+name,+method,+class</tt>).</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.metrics.ANT"></a><tt class="option">metrics</tt></td><td align="left">Specifies the threshold coverage metric values for
		  a given set of columns (all coverage percentages that are
		  below a given threshold are marked up in the report types
		  that support this). The value is a comma-separated list of
		  column id-value pairs, with the value being the minimum
		  required coverage percentage. Setting this attribute is the same as setting
		  the <tt class="option"><a href="#prop-ref.report.metrics">report.metrics</a></tt> property for
		  all report types (default:
		  <tt class="option">method:70,block:80,line:80,class:100</tt>).</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.encoding.ANT"></a><tt class="option">encoding</tt></td><td align="left">Sets the charset id for report output files (this
		  is best done at the individual report type
		  level). Setting this attribute is the same as setting
		  the <tt class="option"><a href="#prop-ref.report.out.encoding">report.out.encoding</a></tt> property for
		  all report types (default values are report type-specific, see below).</td><td align="left">No</td></tr></tbody></table></div>
          </p><h4><a name="N10DCE"></a>Parameters specified as nested elements</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Element</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task nested elements</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.nested.infileset.ANT"></a><tt class="option">&lt;infileset&gt;</tt>, <tt class="option">&lt;fileset&gt;</tt></td><td align="left">A <i class="citetitle">FileSet</i> that selects a set
		  of  <a href="#mdata"><i class="glossterm">metadata</i></a> and
		  <a href="#rdata"><i class="glossterm">coverage data</i></a> files
		  that form the basis of coverage calculations in the
		  generated report(s). It is an error not to include any
		  metadata or any coverage data within this set of files.</td><td align="left">Yes</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.nested.sourcepath.ANT"></a><tt class="option">&lt;sourcepath&gt;</tt></td><td align="left">A <i class="citetitle">path-like structure</i> that specifies an optional
		  source path to use for HTML report generation.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.nested.txt.ANT"></a><tt class="option">&lt;txt&gt;</tt></td><td align="left">Instructs <span><b class="command">&lt;report&gt;</b></span> to generate a
		  plain-text coverage report. The report can be further
		  customized as shown below.</td><td align="left">At least one of <tt class="option">&lt;txt&gt;</tt>,
		  <tt class="option">&lt;html&gt;</tt>,
		  <tt class="option">&lt;xml&gt;</tt> is required</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.nested.html.ANT"></a><tt class="option">&lt;html&gt;</tt></td><td align="left">Instructs <span><b class="command">&lt;report&gt;</b></span> to generate an
		  HTML coverage report. The report can be further
		  customized as shown below.</td><td align="left">At least one of <tt class="option">&lt;txt&gt;</tt>,
		  <tt class="option">&lt;html&gt;</tt>,
		  <tt class="option">&lt;xml&gt;</tt> is required</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.nested.xml.ANT"></a><tt class="option">&lt;xml&gt;</tt></td><td align="left">Instructs <span><b class="command">&lt;report&gt;</b></span> to generate an
		  XML coverage report. The report can be further
		  customized as shown below.</td><td align="left">At least one of <tt class="option">&lt;txt&gt;</tt>,
		  <tt class="option">&lt;html&gt;</tt>,
		  <tt class="option">&lt;xml&gt;</tt> is required</td></tr></tbody></table></div>
        </p><p><b><tt class="option">&lt;infileset&gt;</tt> nested elements.&nbsp;</b><tt class="option">&lt;infileset&gt;</tt> nested elements are configured as
	  any other <a href="http://ant.apache.org/manual/CoreTypes/fileset.html" target="_blank"><i class="citetitle">FileSet</i></a>
	  data type in ANT. Additionally, EMMA's version of
	  <i class="citetitle">FileSet</i> data type allows
	  <tt class="option">file</tt> attribute in ANT versions earlier than
	  1.5.x (which is useful for selecting a single file by its known name without
	  using an explicit <i class="citetitle">PatternSet</i>).</p><p><a name="report.nestedsourcepath"></a><b><tt class="option">&lt;sourcepath&gt;</tt> nested elements.&nbsp;</b><tt class="option">&lt;sourcepath&gt;</tt> is a <a href="http://ant.apache.org/manual/using.html#path" target="_blank"><i class="citetitle">path-like
	  structure</i></a> that can be used to point <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span>
	  to the location of your Java source files. If the
	  HTML report <a href="#tool-ref.report.cfg.depth.ANT">depth</a>
	  is set to <tt class="option">method</tt> and the instrumented classes
	  were compiled with enough debug information, the report generator will
	  embed whichever source files it can find inside the HTML
	  report pages and highlight covered/not covered lines.</p><p><a name="report.nestedcfg"></a><b><tt class="option">&lt;txt&gt;</tt>,
	  <tt class="option">&lt;html&gt;</tt>, and <tt class="option">&lt;xml&gt;</tt> nested elements.&nbsp;</b>These nested elements create plain text, HTML, and XML
	  coverage reports, respectively. At least one report type must be
	  specified (at most one configurator of any given report type
	  can be nested inside a given
	  <span><b class="command">&lt;report&gt;</b></span>). All of them accept the same set of
	  report configuration attributes (if a particular attribute is not
	  specified for an element, its value is inherited
	  from the <span><b class="command">&lt;report&gt;</b></span> parent. If the parent task
	  does not specify an attribute value either, the usual EMMA <a href="#prop-ref.lookup">property inheritance
	  rules</a> determine the eventual value):</p><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.units.ANT"></a><tt class="option">units</tt></td><td align="left">Overrides the coverage metric <a href="#tool-ref.report.units.ANT">units</a> for a given report
		  type. It is perhaps best to set this at the parent
		  <span><b class="command">&lt;report&gt;</b></span> level, so that all
		  generated reports use consistent units.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.depth.ANT"></a><tt class="option">depth</tt></td><td align="left">Overrides the report <a href="#tool-ref.report.depth.ANT">depth</a> for a given report
		  type. The default values are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">txt</tt> report: <tt class="option">all</tt></li><li><tt class="option">html</tt> report: <tt class="option">method</tt></li><li><tt class="option">xml</tt> report: <tt class="option">method</tt></li></ul></div>
                  </td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.columns.ANT"></a><tt class="option">columns</tt></td><td align="left">Overrides the report <a href="#tool-ref.report.columns.ANT">column selection and order</a> for a given report
		  type.The default values are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">txt</tt> report: <tt class="option">class,method,block,line,name</tt></li><li><tt class="option">html</tt> report: <tt class="option">name,class,method,block,line</tt></li><li><tt class="option">xml</tt> report: <tt class="option">name,class,method,block,line</tt></li></ul></div></td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.sort.ANT"></a><tt class="option">sort</tt></td><td align="left">Overrides the report <a href="#tool-ref.report.sort.ANT">column sort order</a> for a given report
		  type.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.metrics.ANT"></a><tt class="option">metrics</tt></td><td align="left">Overrides the report <a href="#tool-ref.report.columns.ANT">coverage metrics thresholds</a> for a given report
		  type. It is perhaps best to set this at the parent
		  <span><b class="command">&lt;report&gt;</b></span> level, so that all
		  generated reports use consistent metrics.</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.outfile.ANT"></a><tt class="option">outfile</tt></td><td align="left">Overrides the default report output file
		  location. 
                  The default settings are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">txt</tt> report: file <tt class="filename">coverage.txt</tt> in the current directory</li><li><tt class="option">html</tt> report: file
		      <tt class="filename">coverage/index.html</tt> (note that
		      the HTML report is usually split over multiple files,
		      so it is best to specify a file pathname that is
		      inside a dedicated subdirectory)</li><li><tt class="option">xml</tt> report: file <tt class="filename">coverage.xml</tt> in the current directory</li></ul></div>
                  </td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.report.cfg.encoding.ANT"></a><tt class="option">encoding</tt></td><td align="left">Overrides the <a href="#tool-ref.report.encoding.ANT">output file charset
		  encoding</a> used for a given report type. The default values are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">txt</tt> report:
		      mirrors the <tt class="option">file.encoding</tt> JRE system
		      property</li><li><tt class="option">html</tt> report: <tt class="option">ISO-8859-1</tt></li><li><tt class="option">xml</tt> report: <tt class="option">UTF-8</tt></li></ul></div>
                  </td><td align="left">No</td></tr></tbody></table></div>
        </p><h4><a name="N10F9E"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>Generate plain text and XML report types, all with default settings:
<pre class="programlisting">
    &lt;emma enabled="${emma.enabled}" &gt;
      &lt;report &gt;
        &lt;!-- collect all EMMA data dumps (metadata and runtime): --&gt;
        &lt;infileset dir="${coverage.dir}" includes="*.em, *.ec" /&gt;

        &lt;txt /&gt;
        &lt;xml /&gt;
      &lt;/report&gt;
    &lt;/emma&gt;</pre>
            </p></li><li><p>Generate three report types, with common metrics and column
             sorting, but with different report depth and column orderings:
<pre class="programlisting">
    &lt;emma enabled="${emma.enabled}" &gt;
      &lt;report sourcepath="${src.dir}"
              sort="+block,+name,+method,+class"
              metrics="method:70,block:80,line:80,class:100"
      &gt;
        &lt;infileset dir="${coverage.dir}" includes="*.em, *.ec" /&gt;

        &lt;!-- for every type of report desired, configure a nested
             element; various report parameters
             can be inherited from the parent &lt;report&gt;
             and individually overridden for each report type:
        --&gt;
        &lt;txt outfile="${coverage.dir}/coverage.txt"
             depth="package"
             columns="class,method,block,line,name"
        /&gt;
        &lt;xml outfile="${coverage.dir}/coverage.xml"
             depth="package"
        /&gt;
        &lt;html outfile="${coverage.dir}/coverage.html"
             depth="method"
             columns="name,class,method,block,line"
        /&gt;
      &lt;/report&gt;
    &lt;/emma&gt;</pre>
            </p></li><li><p>Generate an HTML report with some customization, load metadata and runtime
            coverage data from a single session file, use a &lt;dirset&gt; to set the sourcepath:
<pre class="programlisting">
    &lt;emma enabled="${emma.enabled}" &gt;
      &lt;report &gt;
        &lt;infileset file="${coverage.dir}/coverage.es" /&gt;

        &lt;sourcepath&gt;
          &lt;dirset dir="${basedir}" &gt;
            &lt;include name="**/src" /&gt; 
          &lt;/dirset&gt;
        &lt;/sourcepath&gt;

        &lt;html outfile="${coverage.dir}/index.html"
              columns="name, method, line"
              sort="+line, +name"
              metrics="line:80"
        /&gt;
      &lt;/report&gt;
    &lt;/emma&gt;</pre>
            </p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.report.cmdline"></a>4.3.&nbsp;Command line usage</h3></div></div></div><h4><a name="N10FBA"></a>Synopsis</h4><div class="cmdsynopsis"><p><tt class="command">java emma report</tt>  {-in <i class="replaceable"><tt>data&nbsp;files</tt></i>...} {-r <i class="replaceable"><tt>report&nbsp;types</tt></i>...} [-sp <i class="replaceable"><tt>sourcepath</tt></i>...] [<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common&nbsp;options</a></tt>]</p></div><h4><a name="N10FDA"></a>Options</h4><p>[<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common command line options</a></tt>]</p><div class="variablelist"><dl><dt><a name="tool-ref.report.in.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-in, -input <i class="replaceable"><tt>meta/coverage&nbsp;data&nbsp;files</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option selects a set
		  of  <a href="#mdata"><i class="glossterm">metadata</i></a> and
		  <a href="#rdata"><i class="glossterm">coverage data</i></a> files
		  that form the basis of coverage calculations in the
		  generated report(s). It is an error not to include any
		  metadata or any coverage data within this set of files.</dd><dt><a name="tool-ref.report.r.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-r, -report (<tt class="constant">txt</tt>|<tt class="constant">html</tt>|<tt class="constant">xml</tt>)</tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option selects report type(s) to be generated.</dd><dt><a name="tool-ref.report.sp.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-sp, -sourcepath <i class="replaceable"><tt>list&nbsp;of&nbsp;source&nbsp;directories</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option sets the (optional) source path to use for report
		  generation. It is interpreted as a list of
		  directories (separated by the OS-specific classpath
		  separator or comma) containing <tt class="filename">.java</tt>
		  source files. The local path names within each directory
		  should reflect class package names. (Currently, only the HTML report
		  generator uses this data, and only at
		  <tt class="option">method</tt> report depth.)</dd><dt><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">report generation options</tt>... </p></div>
            </span></dt><dd><p>Unlike its ANT equivalent,
	      <span><b class="command">report</b></span> command line tool does not have
	      dedicated options for controlling coverage report generation. If necessary, they can be
	      set using generic <a href="#commonoptions.property.cmdline">-D</a>, <a href="#commonoptions.properties.cmdline">-properties</a>,
	      and other mechanisms.</p><p>So, for example, to change the default location of
	      the HTML report you would override the <tt class="option"><a href="#prop-ref.report.out.file">report.out.file</a></tt> property:

<pre class="screen">
&gt;java emma report -Dreport.html.out.file=mydir/mycoverage.html ...</pre>
             
             (<tt class="option">report.html.out.file</tt> can be abbreviated to
             <tt class="option">report.out.file</tt> if the command generates
             a single report type)</p></dd></dl></div><h4><a name="N11063"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>Generate plain text and XML report types, both with their default settings:
<pre class="screen">
&gt;java emma report -r txt,xml -in coverage.em -in coverage.ec</pre>
            </p></li><li><p>Generate the HTML report only, but override the default
output location:
<pre class="screen">
&gt;java emma report -r html -in coverage.em,coverage.ec -sp src/ -Dreport.html.out.file=mycoverage/coverage.html</pre>
            </p></li><li><p>Generate three report types, with common metrics and column
             sorting, but with different report depth and column
             orderings. Use <a href="#commonoptions.properties.cmdline"><tt class="option">-properties</tt></a>
             option to pull in a large number of report property overrides:
<pre class="screen">
&gt;java emma report -r txt,xml,html -props my.properties -in coverage.em,coverage.ec -sp src/</pre>
            where file <tt class="filename">my.properties</tt> contains:
<pre class="programlisting">
report.sort          = +block,+name,+method,+class
report.metrics       = method:70,block:80,line:80,class:100
report.depth         = package

report.txt.out.file  = coverage/coverage.txt
report.txt.columns   = class,method,block,line,name

report.xml.out.file  = coverage/coverage.xml

report.html.out.file = coverage/coverage.html
report.html.depth    = method
report.html.columns  = name,class,method,block,line</pre>
          </p></li><li><p>Generate an HTML report with some customization, load metadata and runtime
            coverage data from a single session file:
<pre class="screen">
&gt;java emma report -r html -in coverage.es -sp src/   \
                  -Dreport.columns=name,method,line  \
                  -Dreport.sort=+line,+name          \
                  -Dreport.metrics=line:80</pre>
            </p></li></ul></div><h4><a name="N1108F"></a>Diagnostics</h4><p>The default EMMA command line tool behavior is not to use
	  <tt class="function">System.exit()</tt> on exit unless an explicit
	  <a href="#commonoptions.cmdline.exit"><tt class="option">-exit</tt></a>
	  option is specified. If that is done, the error codes returned via
	  <tt class="function">System.exit()</tt> are as follows:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col align="right"><col align="left"></colgroup><tbody><tr><td align="right" valign="top"><tt class="constant">0</tt></td><td align="left">Successful completion.</td></tr><tr><td align="right" valign="top"><tt class="constant">1</tt></td><td align="left">Failure due to incorrect option usage. This error
		  code is also returned when command line usage
                  (<a href="#commonoptions.cmdline.h"><tt class="option">-h</tt></a>)
                   is requested explicitly.</td></tr><tr><td align="right" valign="top"><tt class="constant">2</tt></td><td align="left">All other failures.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tool-ref.merge"></a>5.&nbsp;<span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span></h2></div></div></div><p><span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span> &mdash; offline meta- and runtime coverage data compressor.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="N110D9"></a>5.1.&nbsp;Description</h3></div></div></div><p><span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span> is EMMA's offline meta- and runtime coverage data
      compressor. It reads in an arbitrary number of data files
      containing <a href="#mdata"><i class="glossterm">class metadata</i></a> and/or <a href="#rdata"><i class="glossterm">runtime coverage data</i></a> and compresses all
      of it into a single session data file.</p><p><b>Why merge?&nbsp;</b>Despite the fact that all other EMMA tools can do
	  in-memory merging of an arbitrary number of input data files,
	  there are valid reason for using <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span> tool:

            <div class="variablelist"><dl><dt><span class="term">keeping everything together</span></dt><dd><p>Coverage metrics for a particular application
		  could be determined by a large set of meta- and runtime
		  coverage data files, not necessarily collected in a single
		  application run. For example, a Swing client could run in
		  one JVM and a remoted server in another, possibly on a
		  different host machine. Or a testsuite
		  could be spread over a sequence of forked JVM processes.</p><p>Collecting all EMMA data in a single file could
		  be a simple matter of convenience: such a <a href="#sdata"><i class="glossterm">coverage session data</i></a> file is
		  a memento of a particular state of application
		  coverage. Such a session data file
		  contains all the data necessary to regenerate all coverage
		  reports (for <a href="#report.sourcepath">source code
		  embedding</a> in a coverage report you
		  also need to preserve the particular versions of sources
		  used at the instrumentation time: a source revision control system is a
		  good solution for this).</p></dd><dt><span class="term">data compaction</span></dt><dd>When merging data into existing files, for
		  reasons that have to do with performance and
		  making file writes as transactional as possible, EMMA
		  tools use an append-like technique. Once a given data
		  record is written to a file, it is never overwritten
		  (rather, later data writes implicitly override it).
		  What this means is that EMMA's un-merged
		  data files may not always store data in the most compact way
		  possible. Processing them with <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span> eliminates wasted
		  file storage and recovers disk space.</dd></dl></div>

          </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.merge.ANT"></a>5.2.&nbsp;ANT usage</h3></div></div></div><h4><a name="N1111E"></a>Parameters specified as attributes</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task attributes</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.merge.mergefile.ANT"></a><tt class="option">mergefile</tt>, <tt class="option">outfile</tt>, <tt class="option">tofile</tt>, <tt class="option">file</tt></td><td align="left">Overrides the location to store merged data
		  (default: file <tt class="filename">coverage.es</tt> in the current
		  directory).</td><td align="left">No.</td></tr></tbody></table></div>
          </p><h4><a name="N11162"></a>Parameters specified as nested elements</h4><p>
          <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Element</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td colspan="2" align="center">[<tt class="option"><a href="#commonoptions.ANT" title="7.1.&nbsp;Common ANT task attributes and nested elements">common EMMA task nested elements</a></tt>]</td><td align="left">No</td></tr><tr><td align="left" valign="top"><a name="tool-ref.merge.nested.infileset.ANT"></a><tt class="option">&lt;infileset&gt;</tt>, <tt class="option">&lt;fileset&gt;</tt></td><td align="left">A <i class="citetitle">FileSet</i> that selects an
		  arbitrary mix of  <a href="#mdata"><i class="glossterm">metadata</i></a> and
		  <a href="#rdata"><i class="glossterm">coverage data</i></a> to be
		  merged. </td><td align="left">Yes</td></tr></tbody></table></div>
        </p><p><b><tt class="option">&lt;infileset&gt;</tt> nested elements.&nbsp;</b><tt class="option">&lt;infileset&gt;</tt> nested elements are configured as
	  any other <a href="http://ant.apache.org/manual/CoreTypes/fileset.html" target="_blank"><i class="citetitle">FileSet</i></a>
	  data type in ANT. Additionally, EMMA's version of
	  <i class="citetitle">FileSet</i> data type allows
	  <tt class="option">file</tt> attribute in ANT versions earlier than
	  1.5.x (which is useful for selecting a single file by its known name without
	  using an explicit <i class="citetitle">PatternSet</i>).</p><h4><a name="N111BF"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>Collect all EMMA metadata and runtime coverage data files
            and merge them into a single session file:
<pre class="programlisting">
    &lt;emma&gt;
      &lt;merge outfile="${coverage.dir}/coverage.es" &gt;
        &lt;fileset dir="${coverage.dir}" includes="*.em, *.ec" /&gt;
      &lt;/merge&gt;
    &lt;/emma&gt;</pre>
            </p></li><li><p>Compact a single data file:
<pre class="programlisting">
    &lt;emma&gt;
      &lt;merge outfile="${coverage.dir}/coverage.es" &gt;
        &lt;fileset file="${coverage.dir}/coverage.es" /&gt;
      &lt;/merge&gt;
    &lt;/emma&gt;</pre>
            </p></li></ul></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tool-ref.merge.cmdline"></a>5.3.&nbsp;Command line usage</h3></div></div></div><h4><a name="N111D4"></a>Synopsis</h4><div class="cmdsynopsis"><p><tt class="command">java emma merge</tt>  {-in <i class="replaceable"><tt>data&nbsp;files</tt></i>...} [-out <i class="replaceable"><tt>data&nbsp;file</tt></i>] [<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common&nbsp;options</a></tt>]</p></div><h4><a name="N111EE"></a>Options</h4><p>[<tt class="option"><a href="#commonoptions.cmdline" title="7.2.&nbsp;Common command line options">common command line options</a></tt>]</p><div class="variablelist"><dl><dt><a name="tool-ref.merge.in.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-in, -input <i class="replaceable"><tt>meta/coverage&nbsp;data&nbsp;files</tt></i></tt>... </p></div>
            </span></dt><dd>This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option selects an
	      arbitrary mix of  <a href="#mdata"><i class="glossterm">metadata</i></a> and
	      <a href="#rdata"><i class="glossterm">coverage data</i></a> files
	      to be merged.</dd><dt><a name="tool-ref.merge.out.cmdline"></a><span class="term">
              <div class="cmdsynopsis"><p> <tt class="option">-out, -outfile <i class="replaceable"><tt>output&nbsp;merge&nbsp;data&nbsp;file</tt></i></tt> </p></div>
            </span></dt><dd>Overrides the location to store merged data
		  (default: file <tt class="filename">coverage.es</tt> in the current
		  directory).</dd></dl></div><h4><a name="N1122A"></a>Examples</h4><div class="itemizedlist"><ul type="disc"><li><p>Collect all EMMA metadata and runtime coverage data files
            and merge them into a single session file:
<pre class="screen">
&gt;java emma merge -in coverage.em -in coverage.ec -out coverage.es</pre>
            </p></li><li><p>Compact a single data file:
<pre class="screen">
&gt;java emma merge -in coverage.es -out coverage.es</pre>
            </p></li></ul></div><h4><a name="N1123B"></a>Diagnostics</h4><p>The default EMMA command line tool behavior is not to use
	  <tt class="function">System.exit()</tt> on exit unless an explicit
	  <a href="#commonoptions.cmdline.exit"><tt class="option">-exit</tt></a>
	  option is specified. If that is done, the error codes returned via
	  <tt class="function">System.exit()</tt> are as follows:</p><div class="informaltable"><table width="100%" border="0"><colgroup><col align="right"><col align="left"></colgroup><tbody><tr><td align="right" valign="top"><tt class="constant">0</tt></td><td align="left">Successful completion.</td></tr><tr><td align="right" valign="top"><tt class="constant">1</tt></td><td align="left">Failure due to incorrect option usage. This error
		  code is also returned when command line usage
                  (<a href="#commonoptions.cmdline.h"><tt class="option">-h</tt></a>)
                   is requested explicitly.</td></tr><tr><td align="right" valign="top"><tt class="constant">2</tt></td><td align="left">All other failures.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N11272"></a>6.&nbsp;Defining the instrumentation set</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="instrset.overview"></a>6.1.&nbsp;How EMMA determines which classes get instrumented</h3></div></div></div><p>Although EMMA's instrumentation is very fast (it is usually
	fast enough so that the overall processing time is dominated by file
	I/O), the key to making EMMA into an even faster tool for
	individual development is to make EMMA do just the
	right amount of work, i.e. define the right <span class="emphasis"><em>instrumentation
	set</em></span> of classes.</p><p>Understanding what gets instrumented is
	also important for another reason: EMMA coverage reports are based
	exclusively on the classes in the instrumentation set as implied by
	coverage metadata.</p><p><b>Instrumentation set.&nbsp;</b>The set of classes that get instrumented in a given
	  invocation of a tool like <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> or <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> is determined by the
	  following rules:

            <div class="orderedlist"><ol type="i"><li>First, a set of classes <span class="emphasis"><em>eligible for
		instrumentation</em></span> is determined by an
		<span class="emphasis"><em>instrumentation path</em></span>. For <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span> this
		is set via an <a href="#tool-ref.instr.instrpath">explicit option</a>
		and for <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> it is the same as the application
		classpath. Note that only Java classes contain executable
		code and are eligible for instrumentation: Java interfaces
		are never instrumented by EMMA<sup>[<a href="#ftn.N112B7" name="N112B7">4</a>]</sup>.</li><li>Next, the set of eligible classes as determined by
		the above step can be further narrowed down by a set of
		coverage <a href="#instrset.filters" title="6.2.&nbsp;Coverage filters"><span class="emphasis"><em>inclusion and exclusion
		filters</em></span></a>.</li><li><p>Finally,
                  <div class="itemizedlist"><ul type="disc"><li>in the offline processing mode, all remaining eligible
		      classes are in fact instrumented and added to the metadata;</li><li><p>in the on-the-fly processing mode, <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> behavior
		      with respect to the remaining eligible classes depends
		      on whether the <span class="emphasis"><em>full classpath scan mode</em></span> (<a href="#tool-ref.run.fullmetadata.ANT"><tt class="option">fullmetadata</tt></a>
		       (<a href="#tool-ref.run.f.cmdline"><tt class="option">-f</tt></a>)
		      option) is turned on:
                        <div class="itemizedlist"><ul type="circle"><li>by default, this mode is not on and
			    only the classes actually used by the
			    application are instrumented and added to
			    the coverage metadata (this happens on demand);</li><li>if this mode is on, all remaining
			    eligible classes are added to the metadata
			    (this happens before the application starts running).</li></ul></div>
                      </p></li></ul></div>
                </p></li></ol></div>
          </p><p>What this means in practice is that you choose the right
	set of class directories and archives via the instrumentation path option and then narrow
	it further down via a number of coverage filters, described next.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="instrset.filters"></a>6.2.&nbsp;Coverage filters</h3></div></div></div><p><b>Wildcards.&nbsp;</b>EMMA coverage filters are lists of familiar
	  <tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name
	  patterns:
            <div class="itemizedlist"><ul type="disc"><li>full Java class names are implied, with
	        &ldquo;<span class="quote"><tt class="option">.</tt></span>&rdquo;'s (dots) as Java package separators;</li><li>a &ldquo;<span class="quote"><tt class="option">*</tt></span>&rdquo; in a pattern stands for zero or
	        more class name characters;</li><li>a &ldquo;<span class="quote"><tt class="option">?</tt></span>&rdquo; in a pattern stands for exactly one
	        class name character</li></ul></div>
          </p><p><b>Inclusions and exclusions.&nbsp;</b>Sometimes all you want is to zoom in to a particular Java
	  package and don't want to specify a long list of exclusion
	  patterns (that also needs to be updated each time someone on your
	  team adds a new Java package to the application). Other times, you do want to
	  include all of the application's classes but would like to exclude
	  just a few packages or name patterns (e.g., your testcases or perhaps a
	  package that is well-tested and can be excluded from coverage
	  analysis).</p><p>EMMA coverage filters support all such scenarios and more,
	in a reasonably concise and intuitive fashion. Each coverage filter
	pattern is either an inclusion or an exclusion pattern:
          <div class="itemizedlist"><ul type="disc"><li>By default, a pattern is an inclusion pattern. This
	      can also be made explicit by prefixing it with a
	      &ldquo;<span class="quote"><tt class="option">+</tt></span>&rdquo; (plus sign).</li><li>A pattern is an exclusion pattern if it is prefixed with a
	      &ldquo;<span class="quote"><tt class="option">-</tt></span>&rdquo; (minus sign).</li></ul></div>
        </p><p>Informally, the way inclusions and exclusions work can be
	summarized as follows: a class name is in the
	instrumentation set if it is included and not excluded. An <span class="emphasis"><em>empty</em></span>
	list of inclusion patterns implicitly includes everything (i.e., it
	is like &ldquo;<span class="quote"><tt class="option">+*</tt></span>&rdquo;) and an
	empty list of exclusion patterns implicitly excludes
	nothing. Furthermore, a class name is included if it matches at
	least one of the inclusion patterns and not excluded by any
	exclusion pattern. It is best to show the formal
        matching rule via pseudocode, followed by some examples:
        </p><p><b>Inclusion/exclusion matching algorithm.&nbsp;</b>
<pre class="synopsis">
    if (inclusions is not empty)
    {
        boolean included = false;
                
        foreach (pattern in inclusions)
        {
            if (pattern matches classname)
            {
                included = true;
                break;
            }
        }
                
        if (not included) return classname_is_excluded;
    }

    if (exclusions is not empty)
    {
        foreach (pattern in exclusions)
        {
            if (pattern matches classname) return classname_is_excluded;
        }
    }

    return classname_is_included;
</pre>
          </p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="filtersyntax.ANT"></a>6.2.1.&nbsp;filter syntax: ANT</h4></div></div></div><p>EMMA ANT (sub)tasks that can take instrumentation filter
strings either as a <tt class="option">filter</tt> attribute or as
<tt class="option">&lt;filter&gt;</tt> nested elements follow the same
specification syntax:</p><p><b><tt class="option">filter</tt> attribute.&nbsp;</b>The attribute value is a filter string, which is a list of
inclusion/exclusion patterns, separated with white space and/or commas. Each
inclusion/exclusion pattern is a
<tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name mask, prefixed
with <tt class="option">+</tt> and <tt class="option">-</tt> for inclusion and exclusion,
respectively. It is legal to omit a prefix, in which case the inclusion
prefix, <tt class="option">+</tt>, is implied.</p><p>It is also possible to specify a list of
inclusion/exclusion patterns to be loaded from an external file. To do so, you can set
the <tt class="option">filter</tt> attribute to an <tt class="option">@</tt>-prefixed file name. The file
should contain a list of inclusion/exclusion patterns, one per line (empty
lines and lines starting with a &ldquo;<span class="quote"><tt class="option">#</tt></span>&rdquo; are ignored).</p><p><b><tt class="option">&lt;filter&gt;</tt> nested
element.&nbsp;</b>This nested element can be configured through a
combination of the following attributes:

              <div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><tt class="option">value</tt></td><td align="left">Specifies a list of inclusion/exclusion
patterns, separated with white space and/or commas. Each inclusion/exclusion
pattern is a <tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name mask,
prefixed with <tt class="option">+</tt> and <tt class="option">-</tt> for inclusion and
exclusion, respectively. It is legal to omit a prefix, in which case the
inclusion prefix, <tt class="option">+</tt>, is implied. Note that this attribute
allows you to specify a mixed list of inclusions and exclusions.</td></tr><tr><td align="left" valign="top"><tt class="option">includes</tt></td><td align="left">Specifies a list of patterns, separated with
white space and/or commas. Each pattern is a
<tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name mask, interpreted
as an inclusion pattern. All explicit <tt class="option">+</tt>/<tt class="option">-</tt>
prefixes are ignored.</td></tr><tr><td align="left" valign="top"><tt class="option">excludes</tt></td><td align="left">Specifies a list of patterns, separated with
white space and/or commas. Each pattern is a
<tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name mask, interpreted
as an exclusion pattern. All explicit <tt class="option">+</tt>/<tt class="option">-</tt>
prefixes are ignored.</td></tr><tr><td align="left" valign="top"><tt class="option">file</tt></td><td align="left">Specifies a list of patterns to be loaded from
a file with a given name. The file should contain a list of
inclusion/exclusion patterns, one per line (empty lines and lines starting
with a &ldquo;<span class="quote"><tt class="option">#</tt></span>&rdquo; are ignored). Each inclusion/exclusion  pattern is a
<tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name mask, prefixed
with <tt class="option">+</tt> and <tt class="option">-</tt> for inclusion and exclusion,
respectively. It is legal to omit a prefix, in which case the inclusion
prefix, <tt class="option">+</tt>, is implied. Note that such a file can contain a
mixed list of inclusions and exclusions.</td></tr></tbody></table></div>
        </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">ANT tip</h3><p>Note that if any of these attributes is set to an empty
	  string it is ignored. This is convenient for providing team-wide ANT filter
	  "hooks" that are overridden differently by individual developers
	  using ANT command line (<tt class="option">-Demma.filter=...</tt>, etc).</p></div><h5><a name="N113E6"></a>Examples</h5><p>Note that all these different ways of specifying
instrumentation filters can be used in a combination. The result is a union
of all specified patterns. The following examples all specify the same set
of inclusion/exclusion patterns:</p><div class="itemizedlist"><ul type="disc"><li><p>
<pre class="programlisting">
  &lt;filter includes="com.foo.*" excludes="com.foo.test.*, com.foo.*Test*" /&gt;</pre>
              </p></li><li><p>
<pre class="programlisting">
  &lt;filter includes="com.foo.*" /&gt;
  &lt;filter excludes="com.foo.test.*, com.foo.*Test*" /&gt;</pre>
              </p></li><li><p>
<pre class="programlisting">
  &lt;filter value="+com.foo.*, -com.foo.test.*, -com.foo.*Test*" /&gt;</pre>
              </p></li><li><p>
<pre class="programlisting">
  &lt;filter excludes="com.foo.*Test*" file="myfilters.txt" /&gt;</pre>
            where <tt class="filename">myfilters.txt</tt> file contains these lines:
<pre class="programlisting">
-com.foo.test.*
+com.foo.*</pre>

            </p></li></ul></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="filtersyntax.cmdline"></a>6.2.2.&nbsp;filter syntax: command line</h4></div></div></div><p>EMMA command line tools that can accept instrumentation filter
strings do it via the <tt class="option">-ix</tt> option. This <a href="#repeatable"><i class="glossterm">repeatable</i></a> option should be set to a list of
inclusion/exclusion patterns, separated with white space and/or commas. Each
inclusion/exclusion pattern is a
<tt class="option">*</tt>,<tt class="option">?</tt>-wildcard class name mask, prefixed
with <tt class="option">+</tt> and <tt class="option">-</tt> for inclusion and exclusion,
respectively. It is legal to omit a prefix, in which case the inclusion
prefix, <tt class="option">+</tt>, is implied.</p><p>It is also possible to specify a list of
inclusion/exclusion patterns to be loaded from an external file. To do so, you can set
the option value to point to an <tt class="option">@</tt>-prefixed file name. The file
should contain a list of inclusion/exclusion patterns, one per line (empty
lines and lines starting with a &ldquo;<span class="quote"><tt class="option">#</tt></span>&rdquo; are ignored).</p><h5><a name="N11434"></a>Examples</h5><p>Note that all these different ways of specifying
instrumentation filters can be used in a combination. The result is a union
of all specified patterns. The following examples all specify the same set
of inclusion/exclusion patterns:</p><div class="itemizedlist"><ul type="disc"><li><p>
<pre class="screen">
&gt;java emma ... -ix +com.foo.*,-com.foo.test.*,-com.foo.*Test* ...</pre>
              </p></li><li><p>
<pre class="screen">
&gt;java emma ... -ix com.foo.* -ix -com.foo.test.*,-com.foo.*Test* ...</pre>
              </p></li><li><p>
<pre class="screen">
&gt;java emma ... -ix -com.foo.*Test* -ix @myfilters.txt ...</pre>
            where <tt class="filename">myfilters.txt</tt> file contains these lines:
<pre class="programlisting">
-com.foo.test.*
+com.foo.*</pre>

            </p></li></ul></div></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N11457"></a>7.&nbsp;Common ANT task and command line options</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="commonoptions.ANT"></a>7.1.&nbsp;Common ANT task attributes and nested elements</h3></div></div></div><p>All EMMA tasks and subtasks have a set of common attributes
	and nested elements:</p><div class="table"><a name="N11460"></a><p class="title"><b>Table&nbsp;2.3.&nbsp;Common EMMA ANT task attributes</b></p><table summary="Common EMMA ANT task attributes" border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td align="left" valign="top"><tt class="option">enabled</tt></td><td align="left">If set to <tt class="option">false</tt>, disables the
		  corresponding EMMA ANT task or subtask. This can be used
		  to effect a simple form of build control flow (default:
		  <tt class="option">true</tt>).</td><td align="left">No (everything is enabled by default)</td></tr><tr><td align="left" valign="top"><a name="commonoptions.verbosity.ANT"></a><tt class="option">verbosity</tt></td><td align="left">Sets the verbosity level for a given task or an
		  entire &lt;emma&gt; group of tasks. Valid values in the
		  order of increasing verbosity are:
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">silent</tt> (same as
		      <tt class="option">severe</tt>): only severe errors are reported;</li><li><tt class="option">quiet</tt> (same as
		      <tt class="option">warning</tt>): only warnings and severe
		      errors are reported;</li><li><tt class="option">info</tt>: default
		      verbosity level, with EMMA reporting on
		      completion of various activities, warnings, and
		      errors</li><li><tt class="option">verbose</tt>: this
		      setting makes EMMA chattier than normal, with extra
		      progress reporting;</li><li><tt class="option">trace1</tt>, <tt class="option">trace2</tt>,
		      <tt class="option">trace3</tt>: these settings enable internal
		      tracing (useful mostly for debugging).</li></ul></div>

                  (default: <tt class="option">info</tt>).</td><td align="left">No (defaults to <tt class="option">info</tt>)</td></tr><tr><td align="left" valign="top"><a name="commonoptions.properties.ANT"></a><tt class="option">properties</tt></td><td align="left">This option specifies a pathname for an EMMA
		property override file, in the standard
		<tt class="classname">java.util.Properties</tt> format.
                 
                 See <a href="#prop-ref" title="Chapter&nbsp;3.&nbsp;EMMA Property Reference">Chapter&nbsp;3, <i>EMMA Property Reference</i></a> for more information on
		  setting EMMA properties.</td><td align="left">No</td></tr></tbody></table></div><div class="table"><a name="N114D5"></a><p class="title"><b>Table&nbsp;2.4.&nbsp;Common EMMA ANT task nested elements</b></p><table summary="Common EMMA ANT task nested elements" border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Element</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td align="left" valign="top"><a name="commonoptions.property.ANT"></a><tt class="option">&lt;property&gt;</tt></td><td align="left">This nested element sets a single EMMA property. It is
		  the ANT equivalent of <a href="#commonoptions.property.cmdline"><tt class="option">-D</tt></a>
		  command line option and is provided mostly for internal
		  testing (EMMA ANT tasks provide proper attributes and
		  nested elements for all public tool settings). See <a href="#prop-ref" title="Chapter&nbsp;3.&nbsp;EMMA Property Reference">Chapter&nbsp;3, <i>EMMA Property Reference</i></a>
		  for more information on setting EMMA properties.</td><td align="left">No</td></tr></tbody></table></div><p><b><tt class="option">&lt;property&gt;</tt> nested element.&nbsp;</b>This nested element can be used to set a generic EMMA
	  property as a name-value pair using the following attributes:</p><div class="informaltable"><table border="1"><colgroup><col align="left"><col align="left"><col align="center"></colgroup><thead><tr><th align="left">Attribute</th><th align="left">Description</th><th align="left">Required</th></tr></thead><tbody><tr><td align="left" valign="top"><tt class="option">name</tt></td><td align="left">Property name (without
		    &ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo; prefix).</td><td align="left">Yes</td></tr><tr><td align="left" valign="top"><tt class="option">value</tt></td><td align="left">Property value.</td><td align="left">Yes</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="commonoptions.cmdline"></a>7.2.&nbsp;Common command line options</h3></div></div></div><p>All EMMA command line tools have a set of common options:</p><div class="variablelist"><dl><dt><span class="term">
                <div class="cmdsynopsis"><p><a name="commonoptions.properties.cmdline"></a> <tt class="option">-p, -props, -properties <i class="replaceable"><tt>.properties&nbsp;file</tt></i></tt> </p></div>
              </span></dt><dd>This option specifies a pathname for an EMMA
		property override file, in the standard
		<tt class="classname">java.util.Properties</tt> format. The
		pathname could be either relative (in which case it is resolved relative to the JVM's
		current working directory) or absolute. See <a href="#prop-ref" title="Chapter&nbsp;3.&nbsp;EMMA Property Reference">Chapter&nbsp;3, <i>EMMA Property Reference</i></a> for more
		information on setting EMMA properties.</dd><dt><span class="term">
                <div class="cmdsynopsis"><p><a name="commonoptions.property.cmdline"></a> <tt class="option">-D<i class="replaceable"><tt>name</tt></i>=<i class="replaceable"><tt>value</tt></i>,
		    -D<i class="replaceable"><tt>name</tt></i>:<i class="replaceable"><tt>value</tt></i>,
		    -D<i class="replaceable"><tt>name</tt></i>&nbsp;<i class="replaceable"><tt>value</tt></i>  
		    </tt> </p></div>
              </span></dt><dd>This option sets a single EMMA property. Note
		that this is different from using the JVM
		<tt class="option">-D</tt> option (the
		<i class="replaceable"><tt>name</tt></i> is not
		&ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo;-prefixed). See <a href="#prop-ref" title="Chapter&nbsp;3.&nbsp;EMMA Property Reference">Chapter&nbsp;3, <i>EMMA Property Reference</i></a>
		for more information on EMMA properties.</dd><dt><span class="term">
                <div class="cmdsynopsis"><p><a name="commonoptions.cmdline.exit"></a> <tt class="option">-exit</tt> </p></div>
              </span></dt><dd>To enable tool chaining and integration via <tt class="function">main()</tt>
		entry methods, EMMA command line tools do not terminate via
		<tt class="function">java.lang.System.exit()</tt> by
		default. If desired for shell and makefile integration,
		this can be changed by using this option on the command
		line. The <span class="emphasis"><em>Diagnostics</em></span> section on every
		tool's reference page details the error codes the tool returns to
		the operating system.</dd><dt><span class="term">
                <div class="cmdsynopsis"><p><a name="commonoptions.cmdline.log"></a> <tt class="option">-silent</tt> <br>  <tt class="option">-quiet</tt> <br>  <tt class="option">-verbose</tt> </p></div>
              </span></dt><dd>These options set EMMA tool verbosity levels to
		be much lower than normal, lower than normal, and above
		normal, respectively. These options are shortcuts to setting
		the <tt class="option"><a href="#prop-ref.verbosity.level">verbosity.level</a></tt> property.</dd><dt><span class="term">
                <div class="cmdsynopsis"><p><a name="commonoptions.cmdline.h"></a> <tt class="option">-h, -help</tt> </p></div>
              </span></dt><dd>This option causes EMMA tools to print their
		usage summaries to <tt class="classname">System.out</tt>. The
		longer form of the option results in slightly more detailed
		usage printout.</dd></dl></div></div></div><div class="footnotes"><br><hr align="left" width="100"><div class="footnote"><p><sup>[<a href="#N101AD" name="ftn.N101AD">2</a>] </sup>Usually, <span><b class="command">&lt;emmajava&gt;</b></span>
	    (<span><b class="command">emmarun</b></span>) runs correspond to
	    completely independent application/testsuite runs. However, its
	    <tt class="option">-raw</tt> option could be used to retain coverage
	    session data files across different runs, to be processed later
	    by tools like <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> and <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span>.</p></div><div class="footnote"><p><sup>[<a href="#N107B3" name="ftn.N107B3">3</a>] </sup>ZIP file format does not
		allow incremental updates. For every class archive in the
		instrumentation path, to replace the selected entries
		with their instrumented version EMMA has to create a temporary
		archive that eventually replaces the original. This
		implies that all zip entries not being instrumented must be
		copied from one archive file to the
		other.</p></div><div class="footnote"><p><sup>[<a href="#N112B7" name="ftn.N112B7">4</a>] </sup>Strictly
		speaking, Java interfaces can contain executable bytecode,
		but it usually corresponds to field initializer expressions that
		execute unconditionally when the interface is loaded.</p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="prop-ref"></a>Chapter&nbsp;3.&nbsp;EMMA Property Reference</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#N115EB">1. Specifying EMMA properties</a></span></dt><dt><span class="sect1"><a href="#prop-ref.tables">2. EMMA property summary</a></span></dt></dl></div><p>The behavior of EMMA tools and runtime is influenced by a number of
    EMMA properties (see <a href="#prop-ref.tables" title="2.&nbsp;EMMA property summary">Section&nbsp;2, &ldquo;EMMA property summary&rdquo;</a> for the full list). These properties address several needs:
      <div class="itemizedlist"><ul type="disc"><li>It could be tedious or impractical to specify
	  all individual command line options for
	  certain aspects of EMMA behavior (e.g., coverage report
	  generation properties). A large set of EMMA property value
	  overrides can be kept in a file that is referenced with a single
	  option or from the classpath.</li><li>Certain kinds of instrumented runtimes cannot be
	  configured easily via command line options (e.g., servlets or Enterprise
	  Java Beans (<span class="abbrev">EJBs</span>)). Again, other ways of passing
	  property overrides are need in such cases, such the JVM system options or
	  classpath resource files.</li></ul></div>
    </p><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N115EB"></a>1.&nbsp;Specifying EMMA properties</h2></div></div></div><p>Given an EMMA <i class="replaceable"><tt>property</tt></i> (from
      the tables in <a href="#prop-ref.tables" title="2.&nbsp;EMMA property summary">Section&nbsp;2, &ldquo;EMMA property summary&rdquo;</a>), it can be specified in several different ways:
        <div class="itemizedlist"><ul type="disc"><li>as a JVM system property named
	    <tt class="option">emma.<i class="replaceable"><tt>property</tt></i></tt>;</li><li>as a property named
	    <tt class="option">emma.<i class="replaceable"><tt>property</tt></i></tt>
	    defined in an external
	    <tt class="classname">java.util.Properties</tt> file;</li><li>as a property named
	    <tt class="option"><i class="replaceable"><tt>property</tt></i></tt>
	    defined in a <tt class="classname">java.util.Properties</tt>
	    classloader resource;</li><li>as an explicit ANT task <a href="#commonoptions.property.ANT"><tt class="option">&lt;property&gt;</tt></a> or command
	    line (<a href="#commonoptions.property.cmdline"><tt class="option">-D</tt></a>) property override.</li></ul></div>

      The general rule is that when a property is provided at the JVM system
      level, its name must be prefixed with
      &ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo; in order to be in EMMA namespace.

      </p><h3><a name="N11627"></a>Examples</h3><p>The following shows different ways of overriding the default
      coverage session dump file pathname from ANT or command line. Using
      <tt class="option">emma.properties</tt> or <a href="#commonoptions.properties.ANT"><tt class="option">properties</tt></a>
      ANT is convenient when you want to load a large block of EMMA
      property settings without keeping them in your makefile or
      <tt class="filename">build.xml</tt>:</p><div class="itemizedlist"><ul type="disc"><li><p>From ANT:
<pre class="programlisting">
    &lt;emmajava enabled="${emma.enabled}" libclasspathref="emma.lib" 
              dumpsessiondata="yes" properties="my.properties"
              classname="Main"
              classpathref="run.classpath"
    /&gt;</pre>
          where file <tt class="filename">my.properties</tt> sets
<tt class="option">session.out.file</tt> to some <i class="replaceable"><tt>mydir/myfile</tt></i> value.
          </p></li><li><p>From command line:
<pre class="screen">
&gt;java emmarun -Dsession.out.file=mydir/myfile ...
&gt;java emmarun -properties my.properties ...
&gt;java -cp {directory containing emma.properties} emmarun ...
&gt;java -Demma.session.out.file=mydir/myfile emmarun ...
&gt;java -Demma.properties=my.properties emmarun ...</pre>
          where file <tt class="filename">my.properties</tt> sets
<tt class="option">session.out.file</tt> to some <i class="replaceable"><tt>mydir/myfile</tt></i> value.
          </p></li></ul></div><p><a name="prop-ref.lookup"></a><b>EMMA property lookup order.&nbsp;</b>Because of multiple ways to specify the same EMMA
      property, it is necessary to document the exact property lookup
      mechanism in order to disambiguate potential conflicts. The following
      lists all possible property lookup layers, in the order from the least
      specific to the most specific (in other words, later definitions
      override earlier definitions):

        <div class="orderedlist"><ol type="1"><li>Certain properties like <tt class="option">report.txt.out.encoding</tt>,
	    start out with their default values reflecting Java built-in system properties
	    like <tt class="option">file.encoding</tt>. Other properties have their
	    defaults set in EMMA code.</li><li>A property can be set in an external
	    <tt class="classname">java.util.Properties</tt> file whose
	    pathname is the value of the JVM system property
	    <tt class="option">emma.properties</tt>
	    (<tt class="option">-Demma.properties=<i class="replaceable"><tt>filename</tt></i></tt>).
            EMMA properties in such a file are <span class="emphasis"><em>not</em></span>
	    prefixed with &ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo;.</li><li>A property can be set at the JVM system property level,
	    using
	    <tt class="option">-Demma.<i class="replaceable"><tt>property</tt></i>=<i class="replaceable"><tt>value</tt></i></tt>
	    syntax.</li><li>A property can be set in a classloader resource named
	    <tt class="filename">emma.properties</tt> using the usual
	    <tt class="classname">java.util.Properties</tt> format (<span class="emphasis"><em>without</em></span> the
	    &ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo; prefix). The resource is
	    looked up first in the most specific of the {current, thread
	    context} pair of classloaders. If neither one is more specific,
	    the lookup is done in the current classloader. If the
	    system classloader is more specific than either the current or
	    the context classloader, then the system classloader is
	    used.</li><li>A property can be set in an external
	    <tt class="classname">java.util.Properties</tt> file whose
	    pathname is the value of a <a href="#commonoptions.properties.ANT"><tt class="option">properties</tt></a> ANT
	    task attribute or a <a href="#commonoptions.properties.cmdline"><tt class="option">-properties</tt></a>
	    command line option. EMMA properties in such a file are
	    <span class="emphasis"><em>not</em></span>  prefixed with &ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo;.</li><li>A property can be set via a <a href="#commonoptions.property.ANT"><tt class="option">property</tt></a>
	    ANT task nested element
	    (<tt class="option">&lt;property&nbsp;name='<i class="replaceable"><tt>name</tt></i>'&nbsp;value='<i class="replaceable"><tt>value</tt></i>'/&gt;</tt>)
	    or a <a href="#commonoptions.property.cmdline"><tt class="option">-D</tt></a>
	    EMMA command line option
	    (<tt class="option">-D<i class="replaceable"><tt>property</tt></i>=<i class="replaceable"><tt>value</tt></i></tt>).
	    (<span class="emphasis"><em>Without</em></span> the
	    &ldquo;<span class="quote"><tt class="option">emma.</tt></span>&rdquo; prefix: don't confuse
	    this with JVM system properties.) Note
	    that in the <span><b class="command"><tt class="option">&lt;report&gt;</tt></b></span> task case this mechanism is largely redundant,
	    because all report generation properties have dedicated ANT task
	    attributes.</li></ol></div>
      </p><p><b>Property shortcuts.&nbsp;</b>In the special case of report generation properties
      (<tt class="option">report.*</tt>) there is one additional complication. Any
      property name that follows the
      <tt class="option">report.<i class="replaceable"><tt>name</tt></i></tt> patterns
      is actually a report property <span class="emphasis"><em>shortcut</em></span> in the
      sense that is applies to all report types (plain text, HTML, XML). For
      some aspects of report generation (e.g., <tt class="option">report.units</tt>) this is very
      appropriate, but for others (e.g., <tt class="option">report.out.encoding</tt>) you are likely to want report
      type-specific settings. To do so, you can specify a
      <tt class="option">report.<i class="replaceable"><tt>report_type</tt></i>.<i class="replaceable"><tt>name</tt></i></tt>
      property. For example, <tt class="option">report.txt.out.encoding</tt> is
      more specific than <tt class="option">report.out.encoding</tt> as far as
      the plain-text report generator is concerned. Note that the
      <span><b class="command"><tt class="option">&lt;report&gt;</tt></b></span> ANT task makes this more convenient that
      the command line case, because it provides convenience override attributes on all
      nested <tt class="option">&lt;txt&gt;</tt>, <tt class="option">&lt;html&gt;</tt>,
      etc elements.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="prop-ref.tables"></a>2.&nbsp;EMMA property summary</h2></div></div></div><div class="table"><a name="prop-ref.table.file"></a><p class="title"><b>Table&nbsp;3.1.&nbsp;EMMA file
      output properties</b></p><table summary="EMMA file
      output properties" border="1"><colgroup><col align="left"></colgroup><tbody><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.coverage.out.file"></a>coverage.out.file</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="filename">coverage.ec</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td>EMMA runtime (EMMA-instrumented classes)</td></tr><tr><td><span class="term">Description:</span></td><td><p>In the offline instrumentation mode, setting
		    this property is currently the only way to override the
		    pathname of the runtime coverage output file. If the pathname
		    is not absolute, it is resolved relative to the current
		    JRE directory (<tt class="option">user.dir</tt> system property). Any existing
		    data in the target file is overwritten unless the <tt class="option"><a href="#prop-ref.coverage.out.merge">coverage.out.merge</a></tt> mode is <tt class="option">true</tt>.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.coverage.out.merge"></a>coverage.out.merge</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">true</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td>EMMA runtime (EMMA-instrumented classes)</td></tr><tr><td><span class="term">Description:</span></td><td><p>When runtime coverage data is dumped by
		    EMMA runtime, this property specifies whether any existing data in the
		    target file should be merged into or overwritten.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.metadata.out.file"></a>metadata.out.file</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="filename">coverage.em</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>For tools that can output class
		    instrumentation metadata, this
		    property sets the output file pathname. If the pathname
		    is not absolute, it is resolved relative to the current
		    JRE directory (<tt class="option">user.dir</tt> system property). Any existing
		    data in the target file is overwritten unless the <tt class="option"><a href="#prop-ref.metadata.out.merge">metadata.out.merge</a></tt> mode is <tt class="option">true</tt>.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.metadata.out.merge"></a>metadata.out.merge</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">true</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>For tools that can output class
		    instrumentation metadata, this
		    property specifies whether any existing data in the
		    target file should be merged into or overwritten.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.session.out.file"></a>session.out.file</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="filename">coverage.es</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>For tools that can output combined
		    metadata+coverage (i.e., session) data, this
		    property sets the output file pathname. If the pathname
		    is not absolute, it is resolved relative to the current
		    JRE directory (<tt class="option">user.dir</tt> system property). Any existing
		    data in the target file is overwritten unless the <tt class="option"><a href="#prop-ref.session.out.merge">session.out.merge</a></tt> mode is <tt class="option">true</tt>.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.session.out.merge"></a>session.out.merge</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">true</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>For tools that can output combined
		    metadata+coverage (i.e., session) data, this
		    property specifies whether any existing data in the
		    target file should be merged into or overwritten.</p></td></tr></tbody></table></div>
             </td></tr></tbody></table></div><div class="table"><a name="prop-ref.table.report"></a><p class="title"><b>Table&nbsp;3.2.&nbsp;EMMA report
      generation properties</b></p><table summary="EMMA report
      generation properties" border="1"><colgroup><col align="left"></colgroup><tbody><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.units"></a>report.units</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">instr</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this property
		    selects either weighted (<tt class="option">instr</tt>) or
		    unweighted (<tt class="option">count</tt>) coverage
		    metrics. See <a href="#tool-ref.reportunits" title="Report units.">Report units.</a> for
		    more details.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.depth"></a>report.depth</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><p><span class="emphasis"><em><tt class="option">report.depth</tt></em></span> is set to
		    <tt class="option">method</tt> and overridden for the plain-text
		    report type:
                    <div class="itemizedlist"><ul type="disc"><li><span class="emphasis"><em><tt class="option">report.txt.depth</tt></em></span>: <tt class="option">all</tt></li></ul></div></p></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this
		    property selects the report depth level covered by the
		    report. Valid values (in order of increasing level of
		    detail) are <tt class="option">all</tt>,
		    <tt class="option">package</tt>, <tt class="option">source</tt>,
		    <tt class="option">class</tt>, and <tt class="option">method</tt>. See
		    <a href="#tool-ref.reportdepth" title="Report depth.">Report depth.</a> for more details.
		    </p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.columns"></a>report.columns</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><p><span class="emphasis"><em><tt class="option">report.columns</tt></em></span> is set
		    to <tt class="option">name,class,method,block,line</tt> and
		    overridden for the plain-text report type:
                    <div class="itemizedlist"><ul type="disc"><li><span class="emphasis"><em><tt class="option">report.txt.columns</tt></em></span>: <tt class="option">class,method,block,line,name</tt></li></ul></div></p></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this
		    property specifies which coverage metrics and in which
		    left-to-right order to render in the report output (the
		    XML report is an exception because it is not columnar:
		    instead, the column order is used for top-to-bottom XML
		    element rendering). Valid
		    column ids are the item name and various types of coverage: <tt class="option">name</tt>,
		  <tt class="option">class</tt> (class coverage),
		    <tt class="option">method</tt> (method coverage),
		  <tt class="option">block</tt> (block coverage), and
		    <tt class="option">line</tt> (line coverage). Coverage types that are not available
		  for a given item type and debug info level are
		  automatically ignored. It is perfectly legal so use only a
		    subset of all possible metrics (e.g., reporting both
		    block and line coverages is somewhat of an overkill).</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.sort"></a>report.sort</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">+block,+name,+method,+class</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this
		    property specifies how to sort data by coverage
		    metrics: which metrics to sort by, sort directions, and
		    sort order. It should be set to a comma-separated list
		    of metric ids (<tt class="option">name</tt>, <tt class="option">class</tt>, <tt class="option">method</tt>,
		  <tt class="option">block</tt>, and <tt class="option">line</tt>), with
		    each metric id prefixed with &ldquo;<span class="quote">+</span>&rdquo; for ascending or &ldquo;<span class="quote">-</span>&rdquo; for
		  descending sort direction. Multiple sorts are applied in the
		    left-to-right order of the metric ids as specified by
		    this property. It is perfectly legal to sort only a subset of
		    all possible metrics/columns.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.metrics"></a>report.metrics</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">method:70,block:80,line:80,class:100</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this
		    property specifies how to highlight data that fails
		    minimum coverage requirements (only applies to
		    plain-text and HTML reports). It should be set to a
		    comma-separated list of metric id-value pairs, with the
		    value being the minimum required coverage percentage
		    (separated by a colon). Metrics ids are <tt class="option">name</tt>, <tt class="option">class</tt>, <tt class="option">method</tt>,
		  <tt class="option">block</tt>, and <tt class="option">line</tt>. It is not necessary to specify
		    the required percentage for every metric used in a given
		    report.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.out.file"></a>report.out.file</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><p><span class="emphasis"><em><tt class="option">report.out.file</tt></em></span> is not
		    set and is instead overridden for all report types:
                    <div class="itemizedlist"><ul type="disc"><li><span class="emphasis"><em><tt class="option">report.txt.out.file</tt></em></span>: <tt class="option">coverage.txt</tt></li><li><span class="emphasis"><em><tt class="option">report.html.out.file</tt></em></span>: <tt class="option">coverage/index.html</tt></li><li><span class="emphasis"><em><tt class="option">report.xml.out.file</tt></em></span>: <tt class="option">coverage.xml</tt></li></ul></div></p></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this
		    property can be used to override the default locations
		    for the output files. When a relative pathname is
		    specified, it is resolved relative to the current
		    JRE directory (<tt class="option">user.dir</tt> system
		    property). Note that the HTML report generator creates
		    secondary HTML files beyond the report home page
		    file. These files will be put in a subdirectory that is
		    a sibling of the home page file and it thus makes
		    sense to have at least one subdirectory level specified for
		    <tt class="option">report.html.out.file</tt> (as is the case
		    with the default value). EMMA will create any
		    intermediate output directories as needed. Output files are
		    always overwritten.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.report.out.encoding"></a>report.out.encoding</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><p><span class="emphasis"><em><tt class="option">report.out.encoding</tt></em></span>
		    defaults to the JRE <tt class="option">file.encoding</tt>
		    system property and is overridden for the HTML and XML report types:
                    <div class="itemizedlist"><ul type="disc"><li><span class="emphasis"><em><tt class="option">report.html.out.encoding</tt></em></span>: <tt class="option">ISO-8859-1</tt></li><li><span class="emphasis"><em><tt class="option">report.xml.out.encoding</tt></em></span>: <tt class="option">UTF-8</tt></li></ul></div></p></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>During coverage report generation, this
		    property can be set to customize the character encoding
		    used for the output files. Default values provided by EMMA should
		    be adequate in most situations.</p></td></tr></tbody></table></div>
             </td></tr></tbody></table></div><div class="table"><a name="prop-ref.table.instr"></a><p class="title"><b>Table&nbsp;3.3.&nbsp;EMMA instrumentation properties</b></p><table summary="EMMA instrumentation properties" border="1"><colgroup><col align="left"></colgroup><tbody><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.instr.do_suid_compensation"></a>instr.do_suid_compensation</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">true</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>Because the bytecode instrumentor used by
		    EMMA needs to synthesize a static class initializer
		    when there is none already and because class initializers are
		    considered for serialization UID calculations by the
		    default SUID algorithm, EMMA will add a compensating
		    <tt class="classname">serialVersionUID</tt> field to the
		    instrumented class if this property set to
		    <tt class="option">true</tt>. This is useful for running
		    applications and tests when Java classes are (de)serialized
		    from previously saved content or across client-server
		    connections when not all JVMs are running instrumented
		    classes. This property can be set to
		    <tt class="option">false</tt> to slightly speed up EMMA
		    processing if such compensation is not needed (e.g.,
		    when no serialization is used).</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.instr.exclude_synthetic_methods"></a>instr.exclude_synthetic_methods</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">true</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>Depending on the compiler used, the
		    original application classes can contain any number of
		    "synthetic" methods that implement certain Java language
		    features (class literals, inner class accessors, etc)
		    through bytecode that has no representation in the
		    original sources. In most cases, excluding these methods
		    from instrumentation and coverage reporting is the
		    correct thing to do. This is the default EMMA behavior.</p></td></tr></tbody></table></div>
             </td></tr><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.instr.exclude_bridge_methods"></a>instr.exclude_bridge_methods</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">true</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td><span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span>, <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></td></tr><tr><td><span class="term">Description:</span></td><td><p>J2SE 1.5 compilers introduce a new kind
		    of "synthetic" methods used for mapping new features
		    like generics to the existing class format. These
		    methods do not have a source code representation. In most
		    cases, excluding these methods from instrumentation and coverage reporting is the
		    correct thing to do. This is the default EMMA behavior.</p></td></tr></tbody></table></div>
             </td></tr></tbody></table></div><div class="table"><a name="prop-ref.table.verbosity"></a><p class="title"><b>Table&nbsp;3.4.&nbsp;EMMA logging properties</b></p><table summary="EMMA logging properties" border="1"><colgroup><col align="left"></colgroup><tbody><tr><td align="left">
                <div class="variablelist"><table border="0"><col valign="top" align="left"><tbody><tr><td><span class="term">Property:</span></td><td><span class="emphasis"><em><tt class="option"><a name="prop-ref.verbosity.level"></a>verbosity.level</tt></em></span></td></tr><tr><td><span class="term">Default:</span></td><td><tt class="option">info</tt></td></tr><tr><td><span class="term">Tools&nbsp;affected:</span></td><td>all tools, including EMMA runtime (EMMA-instrumented classes)</td></tr><tr><td><span class="term">Description:</span></td><td><p>This property sets the verbosity of
		    EMMA logging. Valid values are (in the order of
		    increasing verbosity):
                    <div class="itemizedlist"><ul type="disc"><li><tt class="option">silent</tt> (same as
		      <tt class="option">severe</tt>): only severe errors are reported;</li><li><tt class="option">quiet</tt> (same as
		      <tt class="option">warning</tt>): only warnings and severe
		      errors are reported;</li><li><tt class="option">info</tt>: default
		      verbosity level, with EMMA reporting on
		      completion of various activities, warnings, and errors
		      </li><li><tt class="option">verbose</tt>: this
		      setting makes EMMA chattier than normal, with extra
		      progress reporting;</li><li><tt class="option">trace1</tt>, <tt class="option">trace2</tt>,
		      <tt class="option">trace3</tt>: these settings enable internal
		      tracing (useful mostly for debugging).</li></ul></div>
                    </p></td></tr></tbody></table></div>
             </td></tr></tbody></table></div></div></div><div class="glossary"><div class="titlepage"><div><div><h2 class="title"><a name="N11B59"></a>Glossary</h2></div></div></div><dl><dt><a name="coverage.line"></a>line coverage</dt><dd><p>Coverage metric whereby every source line is given a coverage
	percentage. EMMA derives line coverage from basic block
	coverage. The details of this computation are published elsewhere.</p></dd><dt><a name="instr.run"></a>instrumentation run</dt><dd><p>A single invocation of the <span><b class="command">instr</b></span> command
	line tool or the <span><b class="command">&lt;instr&gt;</b></span> ANT task.</p></dd><dt><a name="instr.set"></a>instrumentation set</dt><dd><p>A set of Java <tt class="filename">.class</tt> definitions that are
	included in an EMMA report. Note that this set is usually smaller
	than any set of files input into an EMMA tool because not all input
	classes are executable and users can do additional filtering.</p></dd><dt><a name="mdata"></a>class metadata</dt><dd><p>A set of binary Java class descriptors that record
	details of class structure like the number of methods in a class,
	their name and basic block structure. As long as the original
	classes are not recompiled, the same metadata can be used for any
	number of coverage profiling runs. See also <a href="#tool-ref.instr.mdata" title="Class coverage metadata.">Class coverage metadata.</a>.</p></dd><dt><a name="rdata"></a>coverage runtime data</dt><dd><p>A set of binary Java class descriptors that reflect a
	particular coverage profiling run (which method and basic blocks
	were hit for which class, etc). As long as they correspond to
	the same metadata, several such data sets can be merged together.</p></dd><dt><a name="sdata"></a>coverage session data</dt><dd><p>A combination of <a href="#mdata"><i class="glossterm">metadata</i></a> and <a href="#mdata"><i class="glossterm">runtime coverage data</i></a>, usually obtained
	during an on-the-fly application session or as a result of using
	<span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span> processor. When this combination is consistent (the runtime
	data corresponds to the classes in the metadata), it is
	sufficient for a coverage report to be produced.</p></dd><dt><a name="mergeable"></a>mergeable option</dt><dd><p>See <a href="#repeatable">repeatable option</a>.</p></dd><dt><a name="repeatable"></a>repeatable option</dt><dd><p>An ANT task nested element or a command line
	option that could be used multiple times within a given tool
	invocation, with the resulting property value being
	a union of all provided inputs (with duplicates removed, if that
	makes sense for a given property). In most cases, an individual
	input value can also be a comma-separated list of values.</p></dd></dl></div></div></body></html>