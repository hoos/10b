<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter&nbsp;2.&nbsp;EMMA Tool Reference</title><link href="../skin/css/doc.css" rel="stylesheet" type="text/css"><meta content="DocBook XSL Stylesheets V1.66.1" name="generator"><link rel="start" href="reference.html" title="EMMA Reference Manual"><link rel="up" href="reference.html" title="EMMA Reference Manual"><link rel="prev" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Installation and System Requirements"><link rel="next" href="ch02s02.html" title="2.&nbsp;<emmajava>/emmarun"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">Chapter&nbsp;2.&nbsp;EMMA Tool Reference</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="ch01.html"><img src="../images/prev.gif" alt="Prev"></a>&nbsp;</td><th align="center" width="60%">&nbsp;</th><td align="right" width="20%">&nbsp;<a accesskey="n" href="ch02s02.html"><img src="../images/next.gif" alt="Next"></a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="N100DC"></a>Chapter&nbsp;2.&nbsp;EMMA Tool Reference</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch02.html#tool-ref.overview">1. Overview</a></span></dt><dt><span class="sect1"><a href="ch02s02.html">2. <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02s02.html#N10219">2.1. Description</a></span></dt><dt><span class="sect2"><a href="ch02s02s02.html">2.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="ch02s02s03.html">2.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch02s03.html">3. <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02s03.html#tool-ref.instr.description">3.1. Description</a></span></dt><dt><span class="sect2"><a href="ch02s03s02.html">3.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="ch02s03s03.html">3.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch02s04.html">4. <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02s04.html#N10BF3">4.1. Description</a></span></dt><dt><span class="sect2"><a href="ch02s04s02.html">4.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="ch02s04s03.html">4.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch02s05.html">5. <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span></a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02s05.html#N110D9">5.1. Description</a></span></dt><dt><span class="sect2"><a href="ch02s05s02.html">5.2. ANT usage</a></span></dt><dt><span class="sect2"><a href="ch02s05s03.html">5.3. Command line usage</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch02s06.html">6. Defining the instrumentation set</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02s06.html#instrset.overview">6.1. How EMMA determines which classes get instrumented</a></span></dt><dt><span class="sect2"><a href="ch02s06s02.html">6.2. Coverage filters</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch02s07.html">7. Common ANT task and command line options</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02s07.html#commonoptions.ANT">7.1. Common ANT task attributes and nested elements</a></span></dt><dt><span class="sect2"><a href="ch02s07s02.html">7.2. common&nbsp;options</a></span></dt></dl></dd></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tool-ref.overview"></a>1.&nbsp;Overview</h2></div></div></div><p>EMMA functionality is implemented by a set of components
    responsible for class instrumentation, metadata and coverage data
    processing, and coverage report generation. Each component has
    adapters that expose its functionality as an ANT task and a
    command line tool. To reflect this design, each of the following
    reference subsections starts by detailing the overall functionality
    of a given component, followed by its concrete ANT and command line
    usage.</p><p>The following table summarizes EMMA ANT tasks and their equivalent
    command line tools:</p><p>
      <div class="table"><a name="N100EA"></a><p class="title"><b>Table&nbsp;2.1.&nbsp;EMMA ANT tasks and command line tools</b></p><table summary="EMMA ANT tasks and command line tools" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">ANT task</th><th align="left">Command line tool</th><th align="left">Functionality</th><th align="left">Output</th></tr></thead><tbody><tr><td colspan="4" align="center"><span class="emphasis"><em>on-the-fly
	      processing mode</em></span></td></tr><tr><td align="left"><a href="ch02s02s02.html" title="2.2.&nbsp;ANT usage"><span><b class="command">&lt;emmajava&gt;</b></span></a></td><td align="left"><a href="ch02s02s03.html" title="2.3.&nbsp;Command line usage"><span><b class="command">emmarun</b></span></a></td><td align="left">Executes a standalone Java application in EMMA
	      instrumenting classloader without a separate instrumentation phase.</td><td align="left">One or several coverage reports and (optionally) a coverage
	      session raw data file.</td></tr><tr><td colspan="4" align="center"><span class="emphasis"><em>offline
	      processing mode</em></span></td></tr><tr><td align="left"><a href="ch02s03s02.html" title="3.2.&nbsp;ANT usage"><span><b class="command">&lt;instr&gt;</b></span></a>&nbsp;subtask</td><td align="left"><a href="ch02s03s03.html" title="3.3.&nbsp;Command line usage"><span><b class="command">instr</b></span></a>&nbsp;command</td><td align="left">Instruments a set of classes in a given list of
	      directories and/or archives and output.</td><td align="left">Instrumented classes and archives and a coverage metadata file.</td></tr><tr><td align="left"><a href="ch02s04s02.html" title="4.2.&nbsp;ANT usage"><span><b class="command">&lt;report&gt;</b></span></a>&nbsp;subtask</td><td align="left"><a href="ch02s04s03.html" title="4.3.&nbsp;Command line usage"><span><b class="command">report</b></span></a>&nbsp;command</td><td align="left">Combines class metadata and coverage runtime data to
	      produce coverage reports.</td><td align="left">One or several coverage reports (plain text, HTML, XML).</td></tr><tr><td align="left"><a href="ch02s05s02.html" title="5.2.&nbsp;ANT usage"><span><b class="command">&lt;merge&gt;</b></span></a>&nbsp;subtask</td><td align="left"><a href="ch02s05s03.html" title="5.3.&nbsp;Command line usage"><span><b class="command">merge</b></span></a>&nbsp;command</td><td align="left">Merges and compacts several metadata, coverage, or
	      session data files.</td><td align="left">A single merged coverage session data file.</td></tr></tbody></table></div>
    </p><p><b>Subtasks and commands.&nbsp;</b>For reasons that include modularity and consistency of
      common option behavior EMMA offline coverage tools are used as
      subtasks of the "umbrella" <span><b class="command">&lt;emma&gt;</b></span> ANT
      task:</p><pre class="programlisting">

    &lt;emma ...&gt;
      &lt;merge ...&gt;
        ...
      &lt;/merge&gt;
      &lt;report ...&gt;
        ...
      &lt;/report&gt;
    &lt;/emma&gt;
    </pre><p>or as subcommands of the "umbrella" <span><b class="command">emma</b></span>
    command line command:</p><pre class="screen">
&gt;java emma instr -ip out/classes/ ...
&gt;java emma report -in coverage.em,coverage.ec ...</pre><p>Note that in the ANT case, <span><b class="command">&lt;emma&gt;</b></span> can
    contain an arbitrary sequence of subtasks (including mutliple subtasks of the
    same kind, which are executed in the exact sequence as they are
    specified). In addition to the already mentioned advantages, this allows
    entire blocks of EMMA tool invocations to be enabled/disabled and
    configured using attributes of the parent <span><b class="command">&lt;emma&gt;</b></span> ANT task.</p><p><b>EMMA properties cascade.&nbsp;</b>Some aspects of EMMA tool/task behavior can be modified
	using properties which can be set in a variety of ways: via
	JVM system properties, via an external file, via ANT (sub)task
	attributes or command line tool options. The task-subtask
	organization helps with this EMMA configuration as well. The
	general rule of thumb here is that properties within a more specific
	context (an ANT subtask vs <span><b class="command">&lt;emma&gt;</b></span> parent task, a tool
	setting vs a global JVM	property, etc) inherit their values from the
	surrounding contexts, but can also override them. For complete details see
	<a href="ch03.html#prop-ref.lookup" title="EMMA property lookup order.">EMMA property lookup order.</a></p><p>In the remainder of this manual, the same tool will be
      frequently referred to as
      <span><b class="command">&lt;<i class="replaceable"><tt>ANT_tool_name</tt></i>&gt;</b></span>/<span><b class="command"><i class="replaceable"><tt>command_line_tool_name</tt></i></b></span>.</p><p><b>Overall EMMA processing sequence.&nbsp;</b>The general sequence of steps when using EMMA depends on your
      chosen coverage mode:
        <div class="itemizedlist"><ul type="disc"><li><p>When using EMMA's on-the-fly coverage mode, there is little to do
	    in addition to how you would normally run your application or
	    testsuite: you use
	    <span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span> as the new startup
	    class and optionally tell it where to place the coverage
	    report(s)<sup>[<a href="#ftn.N101AD" name="N101AD">2</a>]</sup>.</p></li><li><p>When using EMMA's offline coverage mode, the general sequence of
	    tool/task invocations is:
              <div class="orderedlist"><ol type="1"><li><p>In one or several passes, use
		  <span><b class="command">&lt;instr&gt;</b></span>/<span><b class="command">instr</b></span>
		  to instrument class directories and archive files.</p></li><li><p>Execute your application or test suite using the
		  instrumented classes (one or several runs).</p></li><li><p>Optionally, merge and compact all <a href="go01.html#mdata"><i class="glossterm">metadata</i></a> and
		  <a href="go01.html#rdata"><i class="glossterm">runtime coverage</i></a> files using <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span>.</p></li><li><p>In one or several passes, use
		  <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> to combine class metadata
		  with the desired runtime coverage
		  data profile(s) and generate the desired coverage report(s).</p></li></ol></div>
            </p></li></ul></div>
      </p><p><b>EMMA data files are untyped.&nbsp;</b>EMMA tools use binary data files for storing instrumentation
      and runtime coverage results. EMMA files are not typed: they do not
      require a particular name or extension. Furthermore, each data file is
      a mini-database that acts as an envelope for an arbitrary sequence of
      metadata and/or runtime coverage data dumps. It is up to the user how to
      structure their work with EMMA: either accumulate everything in a
      single file or use a dedicated file for every tool. The
      only restriction is that EMMA files can only grow (once new data is
      merged in, it cannot be removed).</p></div><div class="footnotes"><br><hr align="left" width="100"><div class="footnote"><p><sup>[<a href="#N101AD" name="ftn.N101AD">2</a>] </sup>Usually, <span><b class="command">&lt;emmajava&gt;</b></span>
	    (<span><b class="command">emmarun</b></span>) runs correspond to
	    completely independent application/testsuite runs. However, its
	    <tt class="option">-raw</tt> option could be used to retain coverage
	    session data files across different runs, to be processed later
	    by tools like <span><b class="command">&lt;report&gt;</b></span>/<span><b class="command">report</b></span> and <span><b class="command">&lt;merge&gt;</b></span>/<span><b class="command">merge</b></span>.</p></div></div></div><div class="navfooter"><hr><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="ch01.html"><img src="../images/prev.gif" alt="Prev"></a>&nbsp;</td><td align="center" width="20%"><a accesskey="u" href="reference.html"><img src="../images/up.gif" alt="Up"></a></td><td align="right" width="40%">&nbsp;<a accesskey="n" href="ch02s02.html"><img src="../images/next.gif" alt="Next"></a></td></tr><tr><td valign="top" align="left" width="40%">Chapter&nbsp;1.&nbsp;Installation and System Requirements&nbsp;</td><td align="center" width="20%"><a accesskey="h" href="reference.html"><img src="../images/home.gif" alt="Home"></a></td><td valign="top" align="right" width="40%">&nbsp;2.&nbsp;<span><b class="command">&lt;emmajava&gt;</b></span>/<span><b class="command">emmarun</b></span></td></tr></table></div></body></html>